<html>

	<head>
		<link rel="shortcut icon" href="../favicon.ico">
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/semantic.min.css" integrity="sha512-8bHTC73gkZ7rZ7vpqUQThUDhqcNFyYi2xgDgPDHc+GXVGHXq+xPjynxIopALmOPqzo9JZj0k6OqqewdGO3EsrQ==" crossorigin="anonymous" />
		<script src="https://code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/semantic.min.js" integrity="sha512-dqw6X88iGgZlTsONxZK9ePmJEFrmHwpuMrsUChjAw1mRUhUITE5QU9pkcSox+ynfLhL15Sv2al5A0LVyDCmtUw==" crossorigin="anonymous"></script>

		<link rel="stylesheet" href="../style.css">
	</head>

	<body>

	<div class="ui inverted menu">
		<a class="item" href="../index.html"> <i class="home icon"></i> Home </a>
		<a class="active item" href="../research.html"> <i class="bug icon"></i> Research Publications</a>
		<a class="item" href="../about.html"> <i class="user secret icon"></i> Whoami </a>
	</div>
	
	
	<div id="releases">
	<table>
	<th>ID</th>
	<th>Product</th>
	<th>Version</th>
	<th>Vulnerability</th>
	<tr>
	<td>CVE-2019-25020</td>
	<td>Scytl Secure Vote (sVote)</td>
	<td>2.1</td>
	<td>Unauthenticated REST Endpoints leading to Secure-Data-Manager admin configuration leak</td>
	</tr>
	</table>
	
	<h1>Description</h1>
	
	All specified Jax-RS REST endpoints in the application don't require authentication.</br>
	An example can be found in the following file: <i>evoting-solution-master/source-code/online-voting-secure-data-manager/secure-data-manager-backend/sdm-ws-rest/src/main/java/com/scytl/products/ov/sdm/ui/ws/rs/application/PreconfigurationResource.java</i></br></br>

	<code>@RequestMapping(method = RequestMethod.POST, produces = "application/json")
    @ResponseStatus(value = HttpStatus.CREATED)
    @ApiOperation(value = "Get configuration", notes = "Service to retrieve the configuration of administration"
        + " boards and election events.", response = String.class)
    public String createElectionEvent() throws IOException {

        transactionInfoProvider.generate(tenantId, "", "");

        secureLogger.log(Level.INFO, new LogContent.LogContentBuilder()
                .logEvent(SdmSecureLogEvent.SDM_SYNCHRONIZING_WITH_AP)
                .createLogInfo());

        String result = null;
        if (!isAdminPortalEnabled) {

            LOGGER.info(
                    "The application is configured to not have connectivity to Admin Portal, " +
                            "check if this is the expected behavior");

            secureLogger.log(Level.ERROR,
                    new LogContent.LogContentBuilder()
                            .logEvent(SdmSecureLogEvent.SDM_SYNCHRONIZATION_WITH_AP_FAILED)
                            .additionalInfo("err_desc",
                                    "The application is configured to not have connectivity to Admin Portal, " +
                                    "check if this is the expected behavior")
                            .createLogInfo());
        }
        // call to end point to download data from administration portal
        else if (preconfigurationRepository.download(configFile)) {
            // process the download data
            result = preconfigurationRepository.readFromFileAndSave(configFile);
        }

        secureLogger.log(Level.INFO, new LogContent.LogContentBuilder()
                .logEvent(SdmSecureLogEvent.SDM_SYNCHRONIZED_WITH_AP_SUCCESSFULLY)
                .createLogInfo());

        return result;
    }
	</code>

	The admin portal is enabled by default:
	<code>evoting-solution-master/source-code/online-voting-secure-data-manager/secure-data-manager-backend/sdm-ws-rest/sdmConfig/admin_portal.properties:adminPortal.enabled=true
evoting-solution-master/source-code/online-voting-secure-data-manager/secure-data-manager-backend/secure-data-manager-services/src/main/java/com/scytl/products/ov/sdm/infrastructure/preconfiguration/PreconfigurationRepositoryImpl.java:    @Value("${adminPortal.enabled:true}")
	</code>
	
	By sending a post request to the following api admin configurations can be recieved.: 
	<code>/sdm-ws-rest/preconfiguration</code>

	
	<h1>Disclosure Timeline</h1>
	<ul>
	<li>Feb 11, 2019 - Submitted vulnerability to vendor </li>
	<li>Feb 13, 2019 - Submitted additional details to vendor</li>
	<li>Feb 13, 2019 - Vendor response (nofix)</li>
	</ul>
	<h1>Credit</h1>
	<p>Jannis Kirschner & Anthony Schneiter from Team SUID</p>
	</div>

	</body>
</html>