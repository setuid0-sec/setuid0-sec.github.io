<html>

	<head>
		<link rel="shortcut icon" href="../favicon.ico">
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/semantic.min.css" integrity="sha512-8bHTC73gkZ7rZ7vpqUQThUDhqcNFyYi2xgDgPDHc+GXVGHXq+xPjynxIopALmOPqzo9JZj0k6OqqewdGO3EsrQ==" crossorigin="anonymous" />
		<script src="https://code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/semantic.min.js" integrity="sha512-dqw6X88iGgZlTsONxZK9ePmJEFrmHwpuMrsUChjAw1mRUhUITE5QU9pkcSox+ynfLhL15Sv2al5A0LVyDCmtUw==" crossorigin="anonymous"></script>

		<link rel="stylesheet" href="../style.css">
	</head>

	<body>

	<div class="ui inverted menu">
		<a class="item" href="../index.html"> <i class="home icon"></i> Home </a>
		<a class="active item" href="../research.html"> <i class="bug icon"></i> Research Publications</a>
		<a class="item" href="../about.html"> <i class="user secret icon"></i> Whoami </a>
	</div>
	
	
	<div id="releases">
	<table>
	<th>ID</th>
	<th>Product</th>
	<th>Version</th>
	<th>Vulnerability</th>
	<tr>
	<td>CVE-2019-25021</td>
	<td>Scytl Secure Vote (sVote)</td>
	<td>2.1</td>
	<td>OrientDB Password</td>
	</tr>
	</table>
	
	<h1>Description</h1>
	
	The secure-data-manager implements an orient database.</br>
	It is possible to observe that the hardcoded credentials are the same for username and password: <i>/source-code/online-voting-secure-data-manager/secure-data-manager-backend/secure-data-manager-services/src/main/java/com/scytl/products/ov/sdm/infrastructure/DatabaseManagerFactory.java</i></br></br>
	<code>public interface DatabaseManagerFactory {
    /**
     * The default user name.
     */
    String DEFAULT_USERNAME = OUser.ADMIN;

    /**
     * The default password.
     */
    String DEFAULT_PASSWORD = OUser.ADMIN;

    /**
     * Creates a new database manager for given URL and the default user. This
     * is a shortcut for
     * {@code newDatabaseManager(url, DEFAULT_USERNAME, DEFAULT_PASSWORD)}.
     *
     * @param url
     *            the URL
     * @return the database manager
     */
    DatabaseManager newDatabaseManager(String url);

    /**
     * Creates a new database manager for given URL and user.
     *
     * @param url
     *            the URL
     * @param username
     *            the user name
     * @param password
     *            the password
     * @return the database manager
     */
    DatabaseManager newDatabaseManager(String url, String username,
            String password);
}
	</code>


	There are two function overloads for the database-manager:</br></br>
	<code>public final class DatabaseManagerFactoryImpl
        implements DatabaseManagerFactory {

    @Override
    public DatabaseManager newDatabaseManager(final String url) {
        return newDatabaseManager(url, DEFAULT_USERNAME, DEFAULT_PASSWORD);
    }

    @Override
    public DatabaseManager newDatabaseManager(final String url,
            final String username, final String password) {
        return new DatabaseManagerImpl(url, username, password);
    }
}
	</code>
	
	However searching for the function only reveals calls to the url:</br>
	<code>evoting-solution-master/source-code/online-voting-secure-data-manager/secure-data-manager-backend/sdm-ws-rest/src/main/java/com/scytl/products/ov/sdm/ui/ws/rs/config/SecureDataManagerConfig.java:        return databaseManagerFactory.newDatabaseManager(databaseURL);
evoting-solution-master/source-code/online-voting-secure-data-manager/secure-data-manager-backend/secure-data-manager-services/src/main/java/com/scytl/products/ov/sdm/infrastructure/DatabaseManagerFactoryImpl.java:    public DatabaseManager newDatabaseManager(final String url) {
evoting-solution-master/source-code/online-voting-secure-data-manager/secure-data-manager-backend/secure-data-manager-services/src/main/java/com/scytl/products/ov/sdm/infrastructure/DatabaseManagerFactoryImpl.java:        return newDatabaseManager(url, DEFAULT_USERNAME, DEFAULT_PASSWORD);
evoting-solution-master/source-code/online-voting-secure-data-manager/secure-data-manager-backend/secure-data-manager-services/src/main/java/com/scytl/products/ov/sdm/infrastructure/DatabaseManagerFactoryImpl.java:    public DatabaseManager newDatabaseManager(final String url,
evoting-solution-master/source-code/online-voting-secure-data-manager/secure-data-manager-backend/secure-data-manager-services/src/main/java/com/scytl/products/ov/sdm/infrastructure/DatabaseManagerFactory.java:     * {@code newDatabaseManager(url, DEFAULT_USERNAME, DEFAULT_PASSWORD)}.
evoting-solution-master/source-code/online-voting-secure-data-manager/secure-data-manager-backend/secure-data-manager-services/src/main/java/com/scytl/products/ov/sdm/infrastructure/DatabaseManagerFactory.java:    DatabaseManager newDatabaseManager(String url);
evoting-solution-master/source-code/online-voting-secure-data-manager/secure-data-manager-backend/secure-data-manager-services/src/main/java/com/scytl/products/ov/sdm/infrastructure/DatabaseManagerFactory.java:    DatabaseManager newDatabaseManager(String url, String username,
evoting-solution-master/source-code/online-voting-secure-data-manager/secure-data-manager-backend/secure-data-manager-services/src/test/java/com/scytl/products/ov/sdm/infrastructure/DatabaseFixture.java:        databaseManager = factory.newDatabaseManager(url);
evoting-solution-master/source-code/online-voting-secure-data-manager/secure-data-manager-backend/secure-data-manager-services/src/test/java/com/scytl/products/ov/sdm/domain/config/ConfigTest.java:        return databaseManagerFactory.newDatabaseManager(url);
evoting-solution-master/source-code/online-voting-secure-data-manager/secure-data-manager-backend/sdm-db-utils/src/main/java/com/scytl/products/ov/sdm/db/utils/SpringConfig.java:        return new DatabaseManagerFactoryImpl().newDatabaseManager(url);
	</code>
	
	Which means the database can be acessed over <b>admin:admin</b>.
	
	
	<h1>Disclosure Timeline</h1>
	<ul>
	<li>Feb 11, 2019 - Submitted vulnerability to vendor</li>
	<li>Feb 13, 2019 - Vendor response (nofix)</li>
	</ul>
	<h1>Credit</h1>
	<p>Jannis Kirschner & Anthony Schneiter from Team SUID</p>
	</div>

	</body>
</html>